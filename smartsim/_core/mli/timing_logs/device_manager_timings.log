from device_manager.py


WorkerDevice

init: 0.0 MiB
name: 0.0 MiB
add_model: 0.0 MiB
remove_model: not called
get_model: 0.0 MiB
__contains__: 0.0 MiB


DeviceManager

Filename: /lus/cflus02/cote/smartsim/SmartSim/smartsim/_core/mli/infrastructure/control/devicemanager.py

Line #    Mem usage    Increment  Occurrences   Line Contents
=============================================================
    91    377.3 MiB    377.3 MiB           1       @profile
    92                                             def _load_model_on_device(
    93                                                 self,
    94                                                 worker: MachineLearningWorkerBase,
    95                                                 batch: RequestBatch,
    96                                                 feature_stores: dict[str, FeatureStore],
    97                                             ) -> None:
    98                                         
    99    671.7 MiB    294.4 MiB           1           model_bytes = worker.fetch_model(batch, feature_stores) #ALERT fetch_model needs ot be checked, comes from torch.jit.load
   100    855.4 MiB    183.7 MiB           1           loaded_model = worker.load_model(batch, model_bytes, self._device.name) #ALERT load_model needs to be checked, this comes from retrieving a value from ddict
   101    855.4 MiB      0.0 MiB           1           self._device.add_model(batch.model_key.key, loaded_model.model)

init: 0.0 MiB
get_device: not called
