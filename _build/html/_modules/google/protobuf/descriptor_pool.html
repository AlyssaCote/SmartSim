

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>google.protobuf.descriptor_pool &mdash; SmartSim 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> SmartSim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/generate.html">Text-Based Configuration Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/developers.html">Developer</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/examples/basic.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/examples/ensembles.html">Generating and Running Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/examples/allocations.html">Working with allocations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/examples/python.html">Using the Python Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/examples/fortran.html">Using the Fortran Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/examples/c-plus.html">Using the C++ Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/examples/urika.html">Connect Jupyter to a Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/examples/MPO.html">Model Parameter Optimization with CrayAI</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/api/experiment.html">Experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/api/client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../doc/api/utilities.html">Utilities</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SmartSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>google.protobuf.descriptor_pool</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for google.protobuf.descriptor_pool</h1><div class="highlight"><pre>
<span></span><span class="c1"># Protocol Buffers - Google&#39;s data interchange format</span>
<span class="c1"># Copyright 2008 Google Inc.  All rights reserved.</span>
<span class="c1"># https://developers.google.com/protocol-buffers/</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are</span>
<span class="c1"># met:</span>
<span class="c1">#</span>
<span class="c1">#     * Redistributions of source code must retain the above copyright</span>
<span class="c1"># notice, this list of conditions and the following disclaimer.</span>
<span class="c1">#     * Redistributions in binary form must reproduce the above</span>
<span class="c1"># copyright notice, this list of conditions and the following disclaimer</span>
<span class="c1"># in the documentation and/or other materials provided with the</span>
<span class="c1"># distribution.</span>
<span class="c1">#     * Neither the name of Google Inc. nor the names of its</span>
<span class="c1"># contributors may be used to endorse or promote products derived from</span>
<span class="c1"># this software without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="c1"># &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="c1"># LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="c1"># A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="c1"># OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="c1"># SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="c1"># LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="c1"># DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="c1"># THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="c1"># (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>

<span class="sd">&quot;&quot;&quot;Provides DescriptorPool to use as a container for proto2 descriptors.</span>

<span class="sd">The DescriptorPool is used in conjection with a DescriptorDatabase to maintain</span>
<span class="sd">a collection of protocol buffer descriptors for use when dynamically creating</span>
<span class="sd">message types at runtime.</span>

<span class="sd">For most applications protocol buffers should be used via modules generated by</span>
<span class="sd">the protocol buffer compiler tool. This should only be used when the type of</span>
<span class="sd">protocol buffers used in an application or library cannot be predetermined.</span>

<span class="sd">Below is a straightforward example on how to use this class:</span>

<span class="sd">  pool = DescriptorPool()</span>
<span class="sd">  file_descriptor_protos = [ ... ]</span>
<span class="sd">  for file_descriptor_proto in file_descriptor_protos:</span>
<span class="sd">    pool.Add(file_descriptor_proto)</span>
<span class="sd">  my_message_descriptor = pool.FindMessageTypeByName(&#39;some.package.MessageType&#39;)</span>

<span class="sd">The message descriptor can be used in conjunction with the message_factory</span>
<span class="sd">module in order to create a protocol buffer class that can be encoded and</span>
<span class="sd">decoded.</span>

<span class="sd">If you want to get a Python class for the specified proto, use the</span>
<span class="sd">helper functions inside google.protobuf.message_factory</span>
<span class="sd">directly instead of this class.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;matthewtoia@google.com (Matt Toia)&#39;</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">google.protobuf</span> <span class="k">import</span> <span class="n">descriptor</span>
<span class="kn">from</span> <span class="nn">google.protobuf</span> <span class="k">import</span> <span class="n">descriptor_database</span>
<span class="kn">from</span> <span class="nn">google.protobuf</span> <span class="k">import</span> <span class="n">text_encoding</span>


<span class="n">_USE_C_DESCRIPTORS</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">_USE_C_DESCRIPTORS</span>  <span class="c1"># pylint: disable=protected-access</span>


<span class="k">def</span> <span class="nf">_Deprecated</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Mark functions as deprecated.&quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">NewFunc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s1">&#39;Call to deprecated function </span><span class="si">%s</span><span class="s1">(). Note: Do add unlinked descriptors &#39;</span>
        <span class="s1">&#39;to descriptor_pool is wrong. Use Add() or AddSerializedFile() &#39;</span>
        <span class="s1">&#39;instead.&#39;</span> <span class="o">%</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
        <span class="n">category</span><span class="o">=</span><span class="ne">DeprecationWarning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
  <span class="n">NewFunc</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span>
  <span class="n">NewFunc</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__doc__</span>
  <span class="n">NewFunc</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">NewFunc</span>


<span class="k">def</span> <span class="nf">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Remove leading period from fully-qualified type name.</span>

<span class="sd">  Due to b/13860351 in descriptor_database.py, types in the root namespace are</span>
<span class="sd">  generated with a leading period. This function removes that prefix.</span>

<span class="sd">  Args:</span>
<span class="sd">    name: A str, the fully-qualified symbol name.</span>

<span class="sd">  Returns:</span>
<span class="sd">    A str, the normalized fully-qualified symbol name.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_OptionsOrNone</span><span class="p">(</span><span class="n">descriptor_proto</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Returns the value of the field `options`, or None if it is not set.&quot;&quot;&quot;</span>
  <span class="k">if</span> <span class="n">descriptor_proto</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;options&#39;</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">descriptor_proto</span><span class="o">.</span><span class="n">options</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="kc">None</span>


<span class="k">def</span> <span class="nf">_IsMessageSetExtension</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">field</span><span class="o">.</span><span class="n">is_extension</span> <span class="ow">and</span>
          <span class="n">field</span><span class="o">.</span><span class="n">containing_type</span><span class="o">.</span><span class="n">has_options</span> <span class="ow">and</span>
          <span class="n">field</span><span class="o">.</span><span class="n">containing_type</span><span class="o">.</span><span class="n">GetOptions</span><span class="p">()</span><span class="o">.</span><span class="n">message_set_wire_format</span> <span class="ow">and</span>
          <span class="n">field</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_MESSAGE</span> <span class="ow">and</span>
          <span class="n">field</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">LABEL_OPTIONAL</span><span class="p">)</span>


<div class="viewcode-block" id="DescriptorPool"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool">[docs]</a><span class="k">class</span> <span class="nc">DescriptorPool</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;A collection of protobufs dynamically constructed by descriptor protos.&quot;&quot;&quot;</span>

  <span class="k">if</span> <span class="n">_USE_C_DESCRIPTORS</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">descriptor_db</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
      <span class="c1"># pylint: disable=protected-access</span>
      <span class="k">return</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">DescriptorPool</span><span class="p">(</span><span class="n">descriptor_db</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descriptor_db</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Initializes a Pool of proto buffs.</span>

<span class="sd">    The descriptor_db argument to the constructor is provided to allow</span>
<span class="sd">    specialized file descriptor proto lookup code to be triggered on demand. An</span>
<span class="sd">    example would be an implementation which will read and compile a file</span>
<span class="sd">    specified in a call to FindFileByName() and not require the call to Add()</span>
<span class="sd">    at all. Results from this database will be cached internally here as well.</span>

<span class="sd">    Args:</span>
<span class="sd">      descriptor_db: A secondary source of file descriptors.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_internal_db</span> <span class="o">=</span> <span class="n">descriptor_database</span><span class="o">.</span><span class="n">DescriptorDatabase</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span> <span class="o">=</span> <span class="n">descriptor_db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enum_descriptors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_service_descriptors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_file_descriptors</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_toplevel_extensions</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># TODO(jieluo): Remove _file_desc_by_toplevel_extension after</span>
    <span class="c1"># maybe year 2020 for compatibility issue (with 3.4.1 only).</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_file_desc_by_toplevel_extension</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_top_enum_values</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># We store extensions in two two-level mappings: The first key is the</span>
    <span class="c1"># descriptor of the message being extended, the second key is the extension</span>
    <span class="c1"># full name or its tag number.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_name</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_CheckConflictRegister</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">,</span> <span class="n">desc_name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if the descriptor name conflicts with another of the same name.</span>

<span class="sd">    Args:</span>
<span class="sd">      desc: Descriptor of a message, enum, service, extension or enum value.</span>
<span class="sd">      desc_name: the full name of desc.</span>
<span class="sd">      file_name: The file name of descriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">register</span><span class="p">,</span> <span class="n">descriptor_type</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">Descriptor</span><span class="p">),</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_enum_descriptors</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">EnumDescriptor</span><span class="p">),</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_service_descriptors</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">ServiceDescriptor</span><span class="p">),</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_toplevel_extensions</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="p">),</span>
        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_top_enum_values</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">EnumValueDescriptor</span><span class="p">)]:</span>
      <span class="k">if</span> <span class="n">desc_name</span> <span class="ow">in</span> <span class="n">register</span><span class="p">:</span>
        <span class="n">old_desc</span> <span class="o">=</span> <span class="n">register</span><span class="p">[</span><span class="n">desc_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">old_desc</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">EnumValueDescriptor</span><span class="p">):</span>
          <span class="n">old_file</span> <span class="o">=</span> <span class="n">old_desc</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">old_file</span> <span class="o">=</span> <span class="n">old_desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">descriptor_type</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">old_file</span> <span class="o">!=</span> <span class="n">file_name</span><span class="p">):</span>
          <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Conflict register for file &quot;&#39;</span> <span class="o">+</span> <span class="n">file_name</span> <span class="o">+</span>
                       <span class="s1">&#39;&quot;: &#39;</span> <span class="o">+</span> <span class="n">desc_name</span> <span class="o">+</span>
                       <span class="s1">&#39; is already defined in file &quot;&#39;</span> <span class="o">+</span>
                       <span class="n">old_file</span> <span class="o">+</span> <span class="s1">&#39;&quot;. Please fix the conflict by adding &#39;</span>
                       <span class="s1">&#39;package name on the proto file, or use different &#39;</span>
                       <span class="s1">&#39;name for the duplication.&#39;</span><span class="p">)</span>
          <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">EnumValueDescriptor</span><span class="p">):</span>
            <span class="n">error_msg</span> <span class="o">+=</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Note: enum values appear as &#39;</span>
                          <span class="s1">&#39;siblings of the enum type instead of &#39;</span>
                          <span class="s1">&#39;children of it.&#39;</span><span class="p">)</span>

          <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="k">return</span>

<div class="viewcode-block" id="DescriptorPool.Add"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.Add">[docs]</a>  <span class="k">def</span> <span class="nf">Add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_desc_proto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds the FileDescriptorProto and its types to this pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      file_desc_proto: The FileDescriptorProto to add.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_internal_db</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">file_desc_proto</span><span class="p">)</span></div>

<div class="viewcode-block" id="DescriptorPool.AddSerializedFile"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.AddSerializedFile">[docs]</a>  <span class="k">def</span> <span class="nf">AddSerializedFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">serialized_file_desc_proto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds the FileDescriptorProto and its types to this pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      serialized_file_desc_proto: A bytes string, serialization of the</span>
<span class="sd">        FileDescriptorProto to add.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># pylint: disable=g-import-not-at-top</span>
    <span class="kn">from</span> <span class="nn">google.protobuf</span> <span class="k">import</span> <span class="n">descriptor_pb2</span>
    <span class="n">file_desc_proto</span> <span class="o">=</span> <span class="n">descriptor_pb2</span><span class="o">.</span><span class="n">FileDescriptorProto</span><span class="o">.</span><span class="n">FromString</span><span class="p">(</span>
        <span class="n">serialized_file_desc_proto</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">file_desc_proto</span><span class="p">)</span></div>

  <span class="c1"># Add Descriptor to descriptor pool is dreprecated. Please use Add()</span>
  <span class="c1"># or AddSerializedFile() to add a FileDescriptorProto instead.</span>
<div class="viewcode-block" id="DescriptorPool.AddDescriptor"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.AddDescriptor">[docs]</a>  <span class="nd">@_Deprecated</span>
  <span class="k">def</span> <span class="nf">AddDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AddDescriptor</span><span class="p">(</span><span class="n">desc</span><span class="p">)</span></div>

  <span class="c1"># Never call this method. It is for internal usage only.</span>
  <span class="k">def</span> <span class="nf">_AddDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a Descriptor to the pool, non-recursively.</span>

<span class="sd">    If the Descriptor contains nested messages or enums, the caller must</span>
<span class="sd">    explicitly register them. This method also registers the FileDescriptor</span>
<span class="sd">    associated with the message.</span>

<span class="sd">    Args:</span>
<span class="sd">      desc: A Descriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">Descriptor</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected instance of descriptor.Descriptor.&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_CheckConflictRegister</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="p">[</span><span class="n">desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AddFileDescriptor</span><span class="p">(</span><span class="n">desc</span><span class="o">.</span><span class="n">file</span><span class="p">)</span>

  <span class="c1"># Add EnumDescriptor to descriptor pool is dreprecated. Please use Add()</span>
  <span class="c1"># or AddSerializedFile() to add a FileDescriptorProto instead.</span>
<div class="viewcode-block" id="DescriptorPool.AddEnumDescriptor"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.AddEnumDescriptor">[docs]</a>  <span class="nd">@_Deprecated</span>
  <span class="k">def</span> <span class="nf">AddEnumDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enum_desc</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AddEnumDescriptor</span><span class="p">(</span><span class="n">enum_desc</span><span class="p">)</span></div>

  <span class="c1"># Never call this method. It is for internal usage only.</span>
  <span class="k">def</span> <span class="nf">_AddEnumDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enum_desc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds an EnumDescriptor to the pool.</span>

<span class="sd">    This method also registers the FileDescriptor associated with the enum.</span>

<span class="sd">    Args:</span>
<span class="sd">      enum_desc: An EnumDescriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">enum_desc</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">EnumDescriptor</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected instance of descriptor.EnumDescriptor.&#39;</span><span class="p">)</span>

    <span class="n">file_name</span> <span class="o">=</span> <span class="n">enum_desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_CheckConflictRegister</span><span class="p">(</span><span class="n">enum_desc</span><span class="p">,</span> <span class="n">enum_desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enum_descriptors</span><span class="p">[</span><span class="n">enum_desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">enum_desc</span>

    <span class="c1"># Top enum values need to be indexed.</span>
    <span class="c1"># Count the number of dots to see whether the enum is toplevel or nested</span>
    <span class="c1"># in a message. We cannot use enum_desc.containing_type at this stage.</span>
    <span class="k">if</span> <span class="n">enum_desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">package</span><span class="p">:</span>
      <span class="n">top_level</span> <span class="o">=</span> <span class="p">(</span><span class="n">enum_desc</span><span class="o">.</span><span class="n">full_name</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                   <span class="o">-</span> <span class="n">enum_desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">top_level</span> <span class="o">=</span> <span class="n">enum_desc</span><span class="o">.</span><span class="n">full_name</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">top_level</span><span class="p">:</span>
      <span class="n">file_name</span> <span class="o">=</span> <span class="n">enum_desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span>
      <span class="n">package</span> <span class="o">=</span> <span class="n">enum_desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">package</span>
      <span class="k">for</span> <span class="n">enum_value</span> <span class="ow">in</span> <span class="n">enum_desc</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span>
            <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">package</span><span class="p">,</span> <span class="n">enum_value</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_CheckConflictRegister</span><span class="p">(</span><span class="n">enum_value</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top_enum_values</span><span class="p">[</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">enum_value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AddFileDescriptor</span><span class="p">(</span><span class="n">enum_desc</span><span class="o">.</span><span class="n">file</span><span class="p">)</span>

  <span class="c1"># Add ServiceDescriptor to descriptor pool is dreprecated. Please use Add()</span>
  <span class="c1"># or AddSerializedFile() to add a FileDescriptorProto instead.</span>
<div class="viewcode-block" id="DescriptorPool.AddServiceDescriptor"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.AddServiceDescriptor">[docs]</a>  <span class="nd">@_Deprecated</span>
  <span class="k">def</span> <span class="nf">AddServiceDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_desc</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AddServiceDescriptor</span><span class="p">(</span><span class="n">service_desc</span><span class="p">)</span></div>

  <span class="c1"># Never call this method. It is for internal usage only.</span>
  <span class="k">def</span> <span class="nf">_AddServiceDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_desc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a ServiceDescriptor to the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      service_desc: A ServiceDescriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">service_desc</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">ServiceDescriptor</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected instance of descriptor.ServiceDescriptor.&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_CheckConflictRegister</span><span class="p">(</span><span class="n">service_desc</span><span class="p">,</span> <span class="n">service_desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span>
                                <span class="n">service_desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_service_descriptors</span><span class="p">[</span><span class="n">service_desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">service_desc</span>

  <span class="c1"># Add ExtensionDescriptor to descriptor pool is dreprecated. Please use Add()</span>
  <span class="c1"># or AddSerializedFile() to add a FileDescriptorProto instead.</span>
<div class="viewcode-block" id="DescriptorPool.AddExtensionDescriptor"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.AddExtensionDescriptor">[docs]</a>  <span class="nd">@_Deprecated</span>
  <span class="k">def</span> <span class="nf">AddExtensionDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extension</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_AddExtensionDescriptor</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span></div>

  <span class="c1"># Never call this method. It is for internal usage only.</span>
  <span class="k">def</span> <span class="nf">_AddExtensionDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extension</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a FieldDescriptor describing an extension to the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      extension: A FieldDescriptor.</span>

<span class="sd">    Raises:</span>
<span class="sd">      AssertionError: when another extension with the same number extends the</span>
<span class="sd">        same message.</span>
<span class="sd">      TypeError: when the specified extension is not a</span>
<span class="sd">        descriptor.FieldDescriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">extension</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="p">)</span> <span class="ow">and</span>
            <span class="n">extension</span><span class="o">.</span><span class="n">is_extension</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected an extension descriptor.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">extension</span><span class="o">.</span><span class="n">extension_scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_toplevel_extensions</span><span class="p">[</span><span class="n">extension</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">extension</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">existing_desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span><span class="p">[</span>
          <span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="p">][</span><span class="n">extension</span><span class="o">.</span><span class="n">number</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">extension</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">existing_desc</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
            <span class="s1">&#39;Extensions &quot;</span><span class="si">%s</span><span class="s1">&quot; and &quot;</span><span class="si">%s</span><span class="s1">&quot; both try to extend message type &quot;</span><span class="si">%s</span><span class="s1">&quot; &#39;</span>
            <span class="s1">&#39;with field number </span><span class="si">%d</span><span class="s1">.&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="n">extension</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span> <span class="n">existing_desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span>
             <span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span> <span class="n">extension</span><span class="o">.</span><span class="n">number</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span><span class="p">[</span><span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="p">][</span>
        <span class="n">extension</span><span class="o">.</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">extension</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_name</span><span class="p">[</span><span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="p">][</span>
        <span class="n">extension</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">extension</span>

    <span class="c1"># Also register MessageSet extensions with the type name.</span>
    <span class="k">if</span> <span class="n">_IsMessageSetExtension</span><span class="p">(</span><span class="n">extension</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_name</span><span class="p">[</span><span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="p">][</span>
          <span class="n">extension</span><span class="o">.</span><span class="n">message_type</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">extension</span>

<div class="viewcode-block" id="DescriptorPool.AddFileDescriptor"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.AddFileDescriptor">[docs]</a>  <span class="nd">@_Deprecated</span>
  <span class="k">def</span> <span class="nf">AddFileDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_desc</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_InternalAddFileDescriptor</span><span class="p">(</span><span class="n">file_desc</span><span class="p">)</span></div>

  <span class="c1"># Never call this method. It is for internal usage only.</span>
  <span class="k">def</span> <span class="nf">_InternalAddFileDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_desc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a FileDescriptor to the pool, non-recursively.</span>

<span class="sd">    If the FileDescriptor contains messages or enums, the caller must explicitly</span>
<span class="sd">    register them.</span>

<span class="sd">    Args:</span>
<span class="sd">      file_desc: A FileDescriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_AddFileDescriptor</span><span class="p">(</span><span class="n">file_desc</span><span class="p">)</span>
    <span class="c1"># TODO(jieluo): This is a temporary solution for FieldDescriptor.file.</span>
    <span class="c1"># FieldDescriptor.file is added in code gen. Remove this solution after</span>
    <span class="c1"># maybe 2020 for compatibility reason (with 3.4.1 only).</span>
    <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">file_desc</span><span class="o">.</span><span class="n">extensions_by_name</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_file_desc_by_toplevel_extension</span><span class="p">[</span>
          <span class="n">extension</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_desc</span>

  <span class="k">def</span> <span class="nf">_AddFileDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_desc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds a FileDescriptor to the pool, non-recursively.</span>

<span class="sd">    If the FileDescriptor contains messages or enums, the caller must explicitly</span>
<span class="sd">    register them.</span>

<span class="sd">    Args:</span>
<span class="sd">      file_desc: A FileDescriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_desc</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FileDescriptor</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Expected instance of descriptor.FileDescriptor.&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_file_descriptors</span><span class="p">[</span><span class="n">file_desc</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_desc</span>

<div class="viewcode-block" id="DescriptorPool.FindFileByName"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindFileByName">[docs]</a>  <span class="k">def</span> <span class="nf">FindFileByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets a FileDescriptor by file name.</span>

<span class="sd">    Args:</span>
<span class="sd">      file_name: The path to the file to get a descriptor for.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A FileDescriptor for the named file.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the file cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_descriptors</span><span class="p">[</span><span class="n">file_name</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">file_proto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_db</span><span class="o">.</span><span class="n">FindFileByName</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="p">:</span>
        <span class="n">file_proto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="o">.</span><span class="n">FindFileByName</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">error</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_proto</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Cannot find a file named </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">file_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ConvertFileProtoToFileDescriptor</span><span class="p">(</span><span class="n">file_proto</span><span class="p">)</span></div>

<div class="viewcode-block" id="DescriptorPool.FindFileContainingSymbol"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindFileContainingSymbol">[docs]</a>  <span class="k">def</span> <span class="nf">FindFileContainingSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the FileDescriptor for the file containing the specified symbol.</span>

<span class="sd">    Args:</span>
<span class="sd">      symbol: The name of the symbol to search for.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A FileDescriptor that contains the specified symbol.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the file cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">symbol</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_InternalFindFileContainingSymbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="c1"># Try fallback database. Build and find again if possible.</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_FindFileContainingSymbolInDb</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_InternalFindFileContainingSymbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Cannot find a file containing </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbol</span><span class="p">)</span></div>

  <span class="k">def</span> <span class="nf">_InternalFindFileContainingSymbol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the already built FileDescriptor containing the specified symbol.</span>

<span class="sd">    Args:</span>
<span class="sd">      symbol: The name of the symbol to search for.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A FileDescriptor that contains the specified symbol.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the file cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span><span class="o">.</span><span class="n">file</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enum_descriptors</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span><span class="o">.</span><span class="n">file</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_descriptors</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span><span class="o">.</span><span class="n">file</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_enum_values</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">file</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_desc_by_toplevel_extension</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>

    <span class="c1"># Try fields, enum values and nested extensions inside a message.</span>
    <span class="n">top_name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">sub_name</span> <span class="o">=</span> <span class="n">symbol</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FindMessageTypeByName</span><span class="p">(</span><span class="n">top_name</span><span class="p">)</span>
      <span class="k">assert</span> <span class="p">(</span><span class="n">sub_name</span> <span class="ow">in</span> <span class="n">message</span><span class="o">.</span><span class="n">extensions_by_name</span> <span class="ow">or</span>
              <span class="n">sub_name</span> <span class="ow">in</span> <span class="n">message</span><span class="o">.</span><span class="n">fields_by_name</span> <span class="ow">or</span>
              <span class="n">sub_name</span> <span class="ow">in</span> <span class="n">message</span><span class="o">.</span><span class="n">enum_values_by_name</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">message</span><span class="o">.</span><span class="n">file</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">AssertionError</span><span class="p">):</span>
      <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Cannot find a file containing </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbol</span><span class="p">)</span>

<div class="viewcode-block" id="DescriptorPool.FindMessageTypeByName"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindMessageTypeByName">[docs]</a>  <span class="k">def</span> <span class="nf">FindMessageTypeByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads the named descriptor from the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      full_name: The full name of the descriptor to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The descriptor for the named type.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the message cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">full_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_FindFileContainingSymbolInDb</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="p">[</span><span class="n">full_name</span><span class="p">]</span></div>

<div class="viewcode-block" id="DescriptorPool.FindEnumTypeByName"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindEnumTypeByName">[docs]</a>  <span class="k">def</span> <span class="nf">FindEnumTypeByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads the named enum descriptor from the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      full_name: The full name of the enum descriptor to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The enum descriptor for the named type.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the enum cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">full_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enum_descriptors</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_FindFileContainingSymbolInDb</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_enum_descriptors</span><span class="p">[</span><span class="n">full_name</span><span class="p">]</span></div>

<div class="viewcode-block" id="DescriptorPool.FindFieldByName"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindFieldByName">[docs]</a>  <span class="k">def</span> <span class="nf">FindFieldByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads the named field descriptor from the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      full_name: The full name of the field descriptor to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The field descriptor for the named field.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the field cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="n">message_name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">field_name</span> <span class="o">=</span> <span class="n">full_name</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">message_descriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FindMessageTypeByName</span><span class="p">(</span><span class="n">message_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">message_descriptor</span><span class="o">.</span><span class="n">fields_by_name</span><span class="p">[</span><span class="n">field_name</span><span class="p">]</span></div>

<div class="viewcode-block" id="DescriptorPool.FindOneofByName"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindOneofByName">[docs]</a>  <span class="k">def</span> <span class="nf">FindOneofByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads the named oneof descriptor from the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      full_name: The full name of the oneof descriptor to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The oneof descriptor for the named oneof.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the oneof cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="n">message_name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">oneof_name</span> <span class="o">=</span> <span class="n">full_name</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">message_descriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FindMessageTypeByName</span><span class="p">(</span><span class="n">message_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">message_descriptor</span><span class="o">.</span><span class="n">oneofs_by_name</span><span class="p">[</span><span class="n">oneof_name</span><span class="p">]</span></div>

<div class="viewcode-block" id="DescriptorPool.FindExtensionByName"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindExtensionByName">[docs]</a>  <span class="k">def</span> <span class="nf">FindExtensionByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads the named extension descriptor from the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      full_name: The full name of the extension descriptor to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A FieldDescriptor, describing the named extension.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the extension cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="c1"># The proto compiler does not give any link between the FileDescriptor</span>
      <span class="c1"># and top-level extensions unless the FileDescriptorProto is added to</span>
      <span class="c1"># the DescriptorDatabase, but this can impact memory usage.</span>
      <span class="c1"># So we registered these extensions by name explicitly.</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toplevel_extensions</span><span class="p">[</span><span class="n">full_name</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="k">pass</span>
    <span class="n">message_name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">extension_name</span> <span class="o">=</span> <span class="n">full_name</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="c1"># Most extensions are nested inside a message.</span>
      <span class="n">scope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FindMessageTypeByName</span><span class="p">(</span><span class="n">message_name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="c1"># Some extensions are defined at file scope.</span>
      <span class="n">scope</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_FindFileContainingSymbolInDb</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scope</span><span class="o">.</span><span class="n">extensions_by_name</span><span class="p">[</span><span class="n">extension_name</span><span class="p">]</span></div>

<div class="viewcode-block" id="DescriptorPool.FindExtensionByNumber"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindExtensionByNumber">[docs]</a>  <span class="k">def</span> <span class="nf">FindExtensionByNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_descriptor</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets the extension of the specified message with the specified number.</span>

<span class="sd">    Extensions have to be registered to this pool by calling</span>
<span class="sd">    AddExtensionDescriptor.</span>

<span class="sd">    Args:</span>
<span class="sd">      message_descriptor: descriptor of the extended message.</span>
<span class="sd">      number: integer, number of the extension field.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A FieldDescriptor describing the extension.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: when no extension with the given number is known for the</span>
<span class="sd">        specified message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span><span class="p">[</span><span class="n">message_descriptor</span><span class="p">][</span><span class="n">number</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_TryLoadExtensionFromDB</span><span class="p">(</span><span class="n">message_descriptor</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
      <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span><span class="p">[</span><span class="n">message_descriptor</span><span class="p">][</span><span class="n">number</span><span class="p">]</span></div>

<div class="viewcode-block" id="DescriptorPool.FindAllExtensions"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindAllExtensions">[docs]</a>  <span class="k">def</span> <span class="nf">FindAllExtensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_descriptor</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Gets all the known extension of a given message.</span>

<span class="sd">    Extensions have to be registered to this pool by calling</span>
<span class="sd">    AddExtensionDescriptor.</span>

<span class="sd">    Args:</span>
<span class="sd">      message_descriptor: descriptor of the extended message.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A list of FieldDescriptor describing the extensions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Fallback to descriptor db if FindAllExtensionNumbers is provided.</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="p">,</span> <span class="s1">&#39;FindAllExtensionNumbers&#39;</span><span class="p">):</span>
      <span class="n">full_name</span> <span class="o">=</span> <span class="n">message_descriptor</span><span class="o">.</span><span class="n">full_name</span>
      <span class="n">all_numbers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="o">.</span><span class="n">FindAllExtensionNumbers</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">all_numbers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span><span class="p">[</span><span class="n">message_descriptor</span><span class="p">]:</span>
          <span class="k">continue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_TryLoadExtensionFromDB</span><span class="p">(</span><span class="n">message_descriptor</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span><span class="p">[</span><span class="n">message_descriptor</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></div>

  <span class="k">def</span> <span class="nf">_TryLoadExtensionFromDB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_descriptor</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Try to Load extensions from decriptor db.</span>

<span class="sd">    Args:</span>
<span class="sd">      message_descriptor: descriptor of the extended message.</span>
<span class="sd">      number: the extension number that needs to be loaded.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="p">:</span>
      <span class="k">return</span>
    <span class="c1"># Only supported when FindFileContainingExtension is provided.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="p">,</span> <span class="s1">&#39;FindFileContainingExtension&#39;</span><span class="p">):</span>
      <span class="k">return</span>

    <span class="n">full_name</span> <span class="o">=</span> <span class="n">message_descriptor</span><span class="o">.</span><span class="n">full_name</span>
    <span class="n">file_proto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="o">.</span><span class="n">FindFileContainingExtension</span><span class="p">(</span>
        <span class="n">full_name</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">file_proto</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
      <span class="n">file_desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ConvertFileProtoToFileDescriptor</span><span class="p">(</span><span class="n">file_proto</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">file_desc</span><span class="o">.</span><span class="n">extensions_by_name</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span><span class="p">[</span><span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="p">][</span>
            <span class="n">extension</span><span class="o">.</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">extension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_name</span><span class="p">[</span><span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="p">][</span>
            <span class="n">extension</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">extension</span>
      <span class="k">for</span> <span class="n">message_type</span> <span class="ow">in</span> <span class="n">file_desc</span><span class="o">.</span><span class="n">message_types_by_name</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">message_type</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_number</span><span class="p">[</span><span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="p">][</span>
              <span class="n">extension</span><span class="o">.</span><span class="n">number</span><span class="p">]</span> <span class="o">=</span> <span class="n">extension</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">_extensions_by_name</span><span class="p">[</span><span class="n">extension</span><span class="o">.</span><span class="n">containing_type</span><span class="p">][</span>
              <span class="n">extension</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">extension</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="n">warn_msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Unable to load proto file </span><span class="si">%s</span><span class="s1"> for extension number </span><span class="si">%d</span><span class="s1">.&#39;</span> <span class="o">%</span>
                  <span class="p">(</span><span class="n">file_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">number</span><span class="p">))</span>
      <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warn_msg</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span>

<div class="viewcode-block" id="DescriptorPool.FindServiceByName"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindServiceByName">[docs]</a>  <span class="k">def</span> <span class="nf">FindServiceByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads the named service descriptor from the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      full_name: The full name of the service descriptor to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The service descriptor for the named service.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the service cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">full_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_descriptors</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_FindFileContainingSymbolInDb</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_descriptors</span><span class="p">[</span><span class="n">full_name</span><span class="p">]</span></div>

<div class="viewcode-block" id="DescriptorPool.FindMethodByName"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.DescriptorPool.FindMethodByName">[docs]</a>  <span class="k">def</span> <span class="nf">FindMethodByName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">full_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Loads the named service method descriptor from the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      full_name: The full name of the method descriptor to load.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The method descriptor for the service method.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the method cannot be found in the pool.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span><span class="n">full_name</span><span class="p">)</span>
    <span class="n">service_name</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">method_name</span> <span class="o">=</span> <span class="n">full_name</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="n">service_descriptor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FindServiceByName</span><span class="p">(</span><span class="n">service_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">service_descriptor</span><span class="o">.</span><span class="n">methods_by_name</span><span class="p">[</span><span class="n">method_name</span><span class="p">]</span></div>

  <span class="k">def</span> <span class="nf">_FindFileContainingSymbolInDb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">symbol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finds the file in descriptor DB containing the specified symbol.</span>

<span class="sd">    Args:</span>
<span class="sd">      symbol: The name of the symbol to search for.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A FileDescriptor that contains the specified symbol.</span>

<span class="sd">    Raises:</span>
<span class="sd">      KeyError: if the file cannot be found in the descriptor database.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">file_proto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_internal_db</span><span class="o">.</span><span class="n">FindFileContainingSymbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="p">:</span>
        <span class="n">file_proto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_descriptor_db</span><span class="o">.</span><span class="n">FindFileContainingSymbol</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">error</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">file_proto</span><span class="p">:</span>
      <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;Cannot find a file containing </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">symbol</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ConvertFileProtoToFileDescriptor</span><span class="p">(</span><span class="n">file_proto</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_ConvertFileProtoToFileDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_proto</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a FileDescriptor from a proto or returns a cached copy.</span>

<span class="sd">    This method also has the side effect of loading all the symbols found in</span>
<span class="sd">    the file into the appropriate dictionaries in the pool.</span>

<span class="sd">    Args:</span>
<span class="sd">      file_proto: The proto to convert.</span>

<span class="sd">    Returns:</span>
<span class="sd">      A FileDescriptor matching the passed in proto.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_descriptors</span><span class="p">:</span>
      <span class="n">built_deps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_GetDeps</span><span class="p">(</span><span class="n">file_proto</span><span class="o">.</span><span class="n">dependency</span><span class="p">))</span>
      <span class="n">direct_deps</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">FindFileByName</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">dependency</span><span class="p">]</span>
      <span class="n">public_deps</span> <span class="o">=</span> <span class="p">[</span><span class="n">direct_deps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">public_dependency</span><span class="p">]</span>

      <span class="n">file_descriptor</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FileDescriptor</span><span class="p">(</span>
          <span class="n">pool</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
          <span class="n">name</span><span class="o">=</span><span class="n">file_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
          <span class="n">package</span><span class="o">=</span><span class="n">file_proto</span><span class="o">.</span><span class="n">package</span><span class="p">,</span>
          <span class="n">syntax</span><span class="o">=</span><span class="n">file_proto</span><span class="o">.</span><span class="n">syntax</span><span class="p">,</span>
          <span class="n">options</span><span class="o">=</span><span class="n">_OptionsOrNone</span><span class="p">(</span><span class="n">file_proto</span><span class="p">),</span>
          <span class="n">serialized_pb</span><span class="o">=</span><span class="n">file_proto</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">(),</span>
          <span class="n">dependencies</span><span class="o">=</span><span class="n">direct_deps</span><span class="p">,</span>
          <span class="n">public_dependencies</span><span class="o">=</span><span class="n">public_deps</span><span class="p">)</span>
      <span class="n">scope</span> <span class="o">=</span> <span class="p">{}</span>

      <span class="c1"># This loop extracts all the message and enum types from all the</span>
      <span class="c1"># dependencies of the file_proto. This is necessary to create the</span>
      <span class="c1"># scope of available message types when defining the passed in</span>
      <span class="c1"># file proto.</span>
      <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">built_deps</span><span class="p">:</span>
        <span class="n">scope</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ExtractSymbols</span><span class="p">(</span>
            <span class="n">dependency</span><span class="o">.</span><span class="n">message_types_by_name</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">scope</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">_PrefixWithDot</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">full_name</span><span class="p">),</span> <span class="n">enum</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">enum</span> <span class="ow">in</span> <span class="n">dependency</span><span class="o">.</span><span class="n">enum_types_by_name</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

      <span class="k">for</span> <span class="n">message_type</span> <span class="ow">in</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">message_type</span><span class="p">:</span>
        <span class="n">message_desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ConvertMessageDescriptor</span><span class="p">(</span>
            <span class="n">message_type</span><span class="p">,</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="n">file_descriptor</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span>
            <span class="n">file_proto</span><span class="o">.</span><span class="n">syntax</span><span class="p">)</span>
        <span class="n">file_descriptor</span><span class="o">.</span><span class="n">message_types_by_name</span><span class="p">[</span><span class="n">message_desc</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">message_desc</span><span class="p">)</span>

      <span class="k">for</span> <span class="n">enum_type</span> <span class="ow">in</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">enum_type</span><span class="p">:</span>
        <span class="n">file_descriptor</span><span class="o">.</span><span class="n">enum_types_by_name</span><span class="p">[</span><span class="n">enum_type</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ConvertEnumDescriptor</span><span class="p">(</span><span class="n">enum_type</span><span class="p">,</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">package</span><span class="p">,</span>
                                        <span class="n">file_descriptor</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>

      <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">extension_proto</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_proto</span><span class="o">.</span><span class="n">extension</span><span class="p">):</span>
        <span class="n">extension_desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_MakeFieldDescriptor</span><span class="p">(</span>
            <span class="n">extension_proto</span><span class="p">,</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">file_descriptor</span><span class="p">,</span>
            <span class="n">is_extension</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">extension_desc</span><span class="o">.</span><span class="n">containing_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetTypeFromScope</span><span class="p">(</span>
            <span class="n">file_descriptor</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="n">extension_proto</span><span class="o">.</span><span class="n">extendee</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_SetFieldType</span><span class="p">(</span><span class="n">extension_proto</span><span class="p">,</span> <span class="n">extension_desc</span><span class="p">,</span>
                           <span class="n">file_descriptor</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
        <span class="n">file_descriptor</span><span class="o">.</span><span class="n">extensions_by_name</span><span class="p">[</span><span class="n">extension_desc</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">extension_desc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_desc_by_toplevel_extension</span><span class="p">[</span><span class="n">extension_desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">file_descriptor</span><span class="p">)</span>

      <span class="k">for</span> <span class="n">desc_proto</span> <span class="ow">in</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">message_type</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_SetAllFieldTypes</span><span class="p">(</span><span class="n">file_proto</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="n">desc_proto</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

      <span class="k">if</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">package</span><span class="p">:</span>
        <span class="n">desc_proto_prefix</span> <span class="o">=</span> <span class="n">_PrefixWithDot</span><span class="p">(</span><span class="n">file_proto</span><span class="o">.</span><span class="n">package</span><span class="p">)</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">desc_proto_prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

      <span class="k">for</span> <span class="n">desc_proto</span> <span class="ow">in</span> <span class="n">file_proto</span><span class="o">.</span><span class="n">message_type</span><span class="p">:</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetTypeFromScope</span><span class="p">(</span>
            <span class="n">desc_proto_prefix</span><span class="p">,</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
        <span class="n">file_descriptor</span><span class="o">.</span><span class="n">message_types_by_name</span><span class="p">[</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span>

      <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">service_proto</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">file_proto</span><span class="o">.</span><span class="n">service</span><span class="p">):</span>
        <span class="n">file_descriptor</span><span class="o">.</span><span class="n">services_by_name</span><span class="p">[</span><span class="n">service_proto</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_MakeServiceDescriptor</span><span class="p">(</span><span class="n">service_proto</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span>
                                        <span class="n">file_proto</span><span class="o">.</span><span class="n">package</span><span class="p">,</span> <span class="n">file_descriptor</span><span class="p">))</span>

      <span class="bp">self</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">file_proto</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_file_descriptors</span><span class="p">[</span><span class="n">file_proto</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">file_descriptor</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_file_descriptors</span><span class="p">[</span><span class="n">file_proto</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

  <span class="k">def</span> <span class="nf">_ConvertMessageDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desc_proto</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_desc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">syntax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Adds the proto to the pool in the specified package.</span>

<span class="sd">    Args:</span>
<span class="sd">      desc_proto: The descriptor_pb2.DescriptorProto protobuf message.</span>
<span class="sd">      package: The package the proto should be located in.</span>
<span class="sd">      file_desc: The file containing this message.</span>
<span class="sd">      scope: Dict mapping short and full symbols to message and enum types.</span>
<span class="sd">      syntax: string indicating syntax of the file (&quot;proto2&quot; or &quot;proto3&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">      The added descriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">package</span><span class="p">:</span>
      <span class="n">desc_name</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">package</span><span class="p">,</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">desc_name</span> <span class="o">=</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">name</span>

    <span class="k">if</span> <span class="n">file_desc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">file_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_desc</span><span class="o">.</span><span class="n">name</span>

    <span class="k">if</span> <span class="n">scope</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">scope</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">nested</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ConvertMessageDescriptor</span><span class="p">(</span>
            <span class="n">nested</span><span class="p">,</span> <span class="n">desc_name</span><span class="p">,</span> <span class="n">file_desc</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span> <span class="n">syntax</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">nested</span> <span class="ow">in</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">nested_type</span><span class="p">]</span>
    <span class="n">enums</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ConvertEnumDescriptor</span><span class="p">(</span><span class="n">enum</span><span class="p">,</span> <span class="n">desc_name</span><span class="p">,</span> <span class="n">file_desc</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                                    <span class="n">scope</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">enum</span> <span class="ow">in</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">enum_type</span><span class="p">]</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_MakeFieldDescriptor</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">desc_name</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">file_desc</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">field</span><span class="p">)]</span>
    <span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_MakeFieldDescriptor</span><span class="p">(</span><span class="n">extension</span><span class="p">,</span> <span class="n">desc_name</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">file_desc</span><span class="p">,</span>
                                  <span class="n">is_extension</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">extension</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">extension</span><span class="p">)]</span>
    <span class="n">oneofs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">descriptor</span><span class="o">.</span><span class="n">OneofDescriptor</span><span class="p">(</span><span class="n">desc</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">desc_name</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">name</span><span class="p">)),</span>
                                   <span class="n">index</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[],</span> <span class="n">desc</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">desc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">oneof_decl</span><span class="p">)]</span>
    <span class="n">extension_ranges</span> <span class="o">=</span> <span class="p">[(</span><span class="n">r</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">r</span><span class="o">.</span><span class="n">end</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">extension_range</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">extension_ranges</span><span class="p">:</span>
      <span class="n">is_extendable</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">is_extendable</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">Descriptor</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">full_name</span><span class="o">=</span><span class="n">desc_name</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
        <span class="n">containing_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
        <span class="n">oneofs</span><span class="o">=</span><span class="n">oneofs</span><span class="p">,</span>
        <span class="n">nested_types</span><span class="o">=</span><span class="n">nested</span><span class="p">,</span>
        <span class="n">enum_types</span><span class="o">=</span><span class="n">enums</span><span class="p">,</span>
        <span class="n">extensions</span><span class="o">=</span><span class="n">extensions</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">_OptionsOrNone</span><span class="p">(</span><span class="n">desc_proto</span><span class="p">),</span>
        <span class="n">is_extendable</span><span class="o">=</span><span class="n">is_extendable</span><span class="p">,</span>
        <span class="n">extension_ranges</span><span class="o">=</span><span class="n">extension_ranges</span><span class="p">,</span>
        <span class="n">file</span><span class="o">=</span><span class="n">file_desc</span><span class="p">,</span>
        <span class="n">serialized_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">serialized_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">syntax</span><span class="o">=</span><span class="n">syntax</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">nested</span> <span class="ow">in</span> <span class="n">desc</span><span class="o">.</span><span class="n">nested_types</span><span class="p">:</span>
      <span class="n">nested</span><span class="o">.</span><span class="n">containing_type</span> <span class="o">=</span> <span class="n">desc</span>
    <span class="k">for</span> <span class="n">enum</span> <span class="ow">in</span> <span class="n">desc</span><span class="o">.</span><span class="n">enum_types</span><span class="p">:</span>
      <span class="n">enum</span><span class="o">.</span><span class="n">containing_type</span> <span class="o">=</span> <span class="n">desc</span>
    <span class="k">for</span> <span class="n">field_index</span><span class="p">,</span> <span class="n">field_desc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">field</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">field_desc</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;oneof_index&#39;</span><span class="p">):</span>
        <span class="n">oneof_index</span> <span class="o">=</span> <span class="n">field_desc</span><span class="o">.</span><span class="n">oneof_index</span>
        <span class="n">oneofs</span><span class="p">[</span><span class="n">oneof_index</span><span class="p">]</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">field_index</span><span class="p">])</span>
        <span class="n">fields</span><span class="p">[</span><span class="n">field_index</span><span class="p">]</span><span class="o">.</span><span class="n">containing_oneof</span> <span class="o">=</span> <span class="n">oneofs</span><span class="p">[</span><span class="n">oneof_index</span><span class="p">]</span>

    <span class="n">scope</span><span class="p">[</span><span class="n">_PrefixWithDot</span><span class="p">(</span><span class="n">desc_name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">desc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_CheckConflictRegister</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_descriptors</span><span class="p">[</span><span class="n">desc_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span>
    <span class="k">return</span> <span class="n">desc</span>

  <span class="k">def</span> <span class="nf">_ConvertEnumDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enum_proto</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_desc</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">containing_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top_level</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a protobuf EnumDescriptor given an EnumDescriptorProto protobuf.</span>

<span class="sd">    Args:</span>
<span class="sd">      enum_proto: The descriptor_pb2.EnumDescriptorProto protobuf message.</span>
<span class="sd">      package: Optional package name for the new message EnumDescriptor.</span>
<span class="sd">      file_desc: The file containing the enum descriptor.</span>
<span class="sd">      containing_type: The type containing this enum.</span>
<span class="sd">      scope: Scope containing available types.</span>
<span class="sd">      top_level: If True, the enum is a top level symbol. If False, the enum</span>
<span class="sd">          is defined inside a message.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The added descriptor</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">package</span><span class="p">:</span>
      <span class="n">enum_name</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">package</span><span class="p">,</span> <span class="n">enum_proto</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">enum_name</span> <span class="o">=</span> <span class="n">enum_proto</span><span class="o">.</span><span class="n">name</span>

    <span class="k">if</span> <span class="n">file_desc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="n">file_name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">file_name</span> <span class="o">=</span> <span class="n">file_desc</span><span class="o">.</span><span class="n">name</span>

    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_MakeEnumValueDescriptor</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">enum_proto</span><span class="o">.</span><span class="n">value</span><span class="p">)]</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">EnumDescriptor</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">enum_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                     <span class="n">full_name</span><span class="o">=</span><span class="n">enum_name</span><span class="p">,</span>
                                     <span class="n">filename</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                                     <span class="n">file</span><span class="o">=</span><span class="n">file_desc</span><span class="p">,</span>
                                     <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span>
                                     <span class="n">containing_type</span><span class="o">=</span><span class="n">containing_type</span><span class="p">,</span>
                                     <span class="n">options</span><span class="o">=</span><span class="n">_OptionsOrNone</span><span class="p">(</span><span class="n">enum_proto</span><span class="p">))</span>
    <span class="n">scope</span><span class="p">[</span><span class="s1">&#39;.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">enum_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_CheckConflictRegister</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_enum_descriptors</span><span class="p">[</span><span class="n">enum_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span>

    <span class="c1"># Add top level enum values.</span>
    <span class="k">if</span> <span class="n">top_level</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
        <span class="n">full_name</span> <span class="o">=</span> <span class="n">_NormalizeFullyQualifiedName</span><span class="p">(</span>
            <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">package</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_CheckConflictRegister</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">full_name</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_top_enum_values</span><span class="p">[</span><span class="n">full_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">desc</span>

  <span class="k">def</span> <span class="nf">_MakeFieldDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_proto</span><span class="p">,</span> <span class="n">message_name</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span>
                           <span class="n">file_desc</span><span class="p">,</span> <span class="n">is_extension</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a field descriptor from a FieldDescriptorProto.</span>

<span class="sd">    For message and enum type fields, this method will do a look up</span>
<span class="sd">    in the pool for the appropriate descriptor for that type. If it</span>
<span class="sd">    is unavailable, it will fall back to the _source function to</span>
<span class="sd">    create it. If this type is still unavailable, construction will</span>
<span class="sd">    fail.</span>

<span class="sd">    Args:</span>
<span class="sd">      field_proto: The proto describing the field.</span>
<span class="sd">      message_name: The name of the containing message.</span>
<span class="sd">      index: Index of the field</span>
<span class="sd">      file_desc: The file containing the field descriptor.</span>
<span class="sd">      is_extension: Indication that this field is for an extension.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An initialized FieldDescriptor object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">message_name</span><span class="p">:</span>
      <span class="n">full_name</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">message_name</span><span class="p">,</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">full_name</span> <span class="o">=</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">name</span>

    <span class="k">return</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">field_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">full_name</span><span class="o">=</span><span class="n">full_name</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">number</span><span class="o">=</span><span class="n">field_proto</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">field_proto</span><span class="o">.</span><span class="n">type</span><span class="p">,</span>
        <span class="n">cpp_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">message_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">enum_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">containing_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">field_proto</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
        <span class="n">has_default_value</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">default_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">is_extension</span><span class="o">=</span><span class="n">is_extension</span><span class="p">,</span>
        <span class="n">extension_scope</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">_OptionsOrNone</span><span class="p">(</span><span class="n">field_proto</span><span class="p">),</span>
        <span class="n">file</span><span class="o">=</span><span class="n">file_desc</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_SetAllFieldTypes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">,</span> <span class="n">desc_proto</span><span class="p">,</span> <span class="n">scope</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets all the descriptor&#39;s fields&#39;s types.</span>

<span class="sd">    This method also sets the containing types on any extensions.</span>

<span class="sd">    Args:</span>
<span class="sd">      package: The current package of desc_proto.</span>
<span class="sd">      desc_proto: The message descriptor to update.</span>
<span class="sd">      scope: Enclosing scope of available types.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">package</span> <span class="o">=</span> <span class="n">_PrefixWithDot</span><span class="p">(</span><span class="n">package</span><span class="p">)</span>

    <span class="n">main_desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetTypeFromScope</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">package</span> <span class="o">==</span> <span class="s1">&#39;.&#39;</span><span class="p">:</span>
      <span class="n">nested_package</span> <span class="o">=</span> <span class="n">_PrefixWithDot</span><span class="p">(</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">nested_package</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">package</span><span class="p">,</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">field_proto</span><span class="p">,</span> <span class="n">field_desc</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">field</span><span class="p">,</span> <span class="n">main_desc</span><span class="o">.</span><span class="n">fields</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_SetFieldType</span><span class="p">(</span><span class="n">field_proto</span><span class="p">,</span> <span class="n">field_desc</span><span class="p">,</span> <span class="n">nested_package</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">extension_proto</span><span class="p">,</span> <span class="n">extension_desc</span> <span class="ow">in</span> <span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">desc_proto</span><span class="o">.</span><span class="n">extension</span><span class="p">,</span> <span class="n">main_desc</span><span class="o">.</span><span class="n">extensions</span><span class="p">)):</span>
      <span class="n">extension_desc</span><span class="o">.</span><span class="n">containing_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetTypeFromScope</span><span class="p">(</span>
          <span class="n">nested_package</span><span class="p">,</span> <span class="n">extension_proto</span><span class="o">.</span><span class="n">extendee</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_SetFieldType</span><span class="p">(</span><span class="n">extension_proto</span><span class="p">,</span> <span class="n">extension_desc</span><span class="p">,</span> <span class="n">nested_package</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">nested_type</span> <span class="ow">in</span> <span class="n">desc_proto</span><span class="o">.</span><span class="n">nested_type</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">_SetAllFieldTypes</span><span class="p">(</span><span class="n">nested_package</span><span class="p">,</span> <span class="n">nested_type</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_SetFieldType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_proto</span><span class="p">,</span> <span class="n">field_desc</span><span class="p">,</span> <span class="n">package</span><span class="p">,</span> <span class="n">scope</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets the field&#39;s type, cpp_type, message_type and enum_type.</span>

<span class="sd">    Args:</span>
<span class="sd">      field_proto: Data about the field in proto format.</span>
<span class="sd">      field_desc: The descriptor to modiy.</span>
<span class="sd">      package: The package the field&#39;s container is in.</span>
<span class="sd">      scope: Enclosing scope of available types.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type_name</span><span class="p">:</span>
      <span class="n">desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetTypeFromScope</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type_name</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">desc</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">):</span>
      <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">Descriptor</span><span class="p">):</span>
        <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_MESSAGE</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_ENUM</span>

    <span class="n">field_desc</span><span class="o">.</span><span class="n">cpp_type</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">ProtoTypeToCppProtoType</span><span class="p">(</span>
        <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_MESSAGE</span>
        <span class="ow">or</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_GROUP</span><span class="p">):</span>
      <span class="n">field_desc</span><span class="o">.</span><span class="n">message_type</span> <span class="o">=</span> <span class="n">desc</span>

    <span class="k">if</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_ENUM</span><span class="p">:</span>
      <span class="n">field_desc</span><span class="o">.</span><span class="n">enum_type</span> <span class="o">=</span> <span class="n">desc</span>

    <span class="k">if</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">LABEL_REPEATED</span><span class="p">:</span>
      <span class="n">field_desc</span><span class="o">.</span><span class="n">has_default_value</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">HasField</span><span class="p">(</span><span class="s1">&#39;default_value&#39;</span><span class="p">):</span>
      <span class="n">field_desc</span><span class="o">.</span><span class="n">has_default_value</span> <span class="o">=</span> <span class="kc">True</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_DOUBLE</span> <span class="ow">or</span>
          <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_FLOAT</span><span class="p">):</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">field_proto</span><span class="o">.</span><span class="n">default_value</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_STRING</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">default_value</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_BOOL</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">default_value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_ENUM</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="n">field_desc</span><span class="o">.</span><span class="n">enum_type</span><span class="o">.</span><span class="n">values_by_name</span><span class="p">[</span>
            <span class="n">field_proto</span><span class="o">.</span><span class="n">default_value</span><span class="p">]</span><span class="o">.</span><span class="n">number</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_BYTES</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="n">text_encoding</span><span class="o">.</span><span class="n">CUnescape</span><span class="p">(</span>
            <span class="n">field_proto</span><span class="o">.</span><span class="n">default_value</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_MESSAGE</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># All other types are of the &quot;int&quot; type.</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">field_proto</span><span class="o">.</span><span class="n">default_value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">field_desc</span><span class="o">.</span><span class="n">has_default_value</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_DOUBLE</span> <span class="ow">or</span>
          <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_FLOAT</span><span class="p">):</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="mf">0.0</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_STRING</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;&#39;</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_BOOL</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_ENUM</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="n">field_desc</span><span class="o">.</span><span class="n">enum_type</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">number</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_BYTES</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
      <span class="k">elif</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">FieldDescriptor</span><span class="o">.</span><span class="n">TYPE_MESSAGE</span><span class="p">:</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="kc">None</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="c1"># All other types are of the &quot;int&quot; type.</span>
        <span class="n">field_desc</span><span class="o">.</span><span class="n">default_value</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">field_desc</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">field_proto</span><span class="o">.</span><span class="n">type</span>

  <span class="k">def</span> <span class="nf">_MakeEnumValueDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value_proto</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a enum value descriptor object from a enum value proto.</span>

<span class="sd">    Args:</span>
<span class="sd">      value_proto: The proto describing the enum value.</span>
<span class="sd">      index: The index of the enum value.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An initialized EnumValueDescriptor object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">EnumValueDescriptor</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">value_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
        <span class="n">number</span><span class="o">=</span><span class="n">value_proto</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
        <span class="n">options</span><span class="o">=</span><span class="n">_OptionsOrNone</span><span class="p">(</span><span class="n">value_proto</span><span class="p">),</span>
        <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_MakeServiceDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service_proto</span><span class="p">,</span> <span class="n">service_index</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span>
                             <span class="n">package</span><span class="p">,</span> <span class="n">file_desc</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Make a protobuf ServiceDescriptor given a ServiceDescriptorProto.</span>

<span class="sd">    Args:</span>
<span class="sd">      service_proto: The descriptor_pb2.ServiceDescriptorProto protobuf message.</span>
<span class="sd">      service_index: The index of the service in the File.</span>
<span class="sd">      scope: Dict mapping short and full symbols to message and enum types.</span>
<span class="sd">      package: Optional package name for the new message EnumDescriptor.</span>
<span class="sd">      file_desc: The file containing the service descriptor.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The added descriptor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">package</span><span class="p">:</span>
      <span class="n">service_name</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">package</span><span class="p">,</span> <span class="n">service_proto</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">service_name</span> <span class="o">=</span> <span class="n">service_proto</span><span class="o">.</span><span class="n">name</span>

    <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_MakeMethodDescriptor</span><span class="p">(</span><span class="n">method_proto</span><span class="p">,</span> <span class="n">service_name</span><span class="p">,</span> <span class="n">package</span><span class="p">,</span>
                                          <span class="n">scope</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">method_proto</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">service_proto</span><span class="o">.</span><span class="n">method</span><span class="p">)]</span>
    <span class="n">desc</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">ServiceDescriptor</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">service_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                        <span class="n">full_name</span><span class="o">=</span><span class="n">service_name</span><span class="p">,</span>
                                        <span class="n">index</span><span class="o">=</span><span class="n">service_index</span><span class="p">,</span>
                                        <span class="n">methods</span><span class="o">=</span><span class="n">methods</span><span class="p">,</span>
                                        <span class="n">options</span><span class="o">=</span><span class="n">_OptionsOrNone</span><span class="p">(</span><span class="n">service_proto</span><span class="p">),</span>
                                        <span class="n">file</span><span class="o">=</span><span class="n">file_desc</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_CheckConflictRegister</span><span class="p">(</span><span class="n">desc</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">,</span> <span class="n">desc</span><span class="o">.</span><span class="n">file</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_service_descriptors</span><span class="p">[</span><span class="n">service_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">desc</span>
    <span class="k">return</span> <span class="n">desc</span>

  <span class="k">def</span> <span class="nf">_MakeMethodDescriptor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_proto</span><span class="p">,</span> <span class="n">service_name</span><span class="p">,</span> <span class="n">package</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span>
                            <span class="n">index</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Creates a method descriptor from a MethodDescriptorProto.</span>

<span class="sd">    Args:</span>
<span class="sd">      method_proto: The proto describing the method.</span>
<span class="sd">      service_name: The name of the containing service.</span>
<span class="sd">      package: Optional package name to look up for types.</span>
<span class="sd">      scope: Scope containing available types.</span>
<span class="sd">      index: Index of the method in the service.</span>

<span class="sd">    Returns:</span>
<span class="sd">      An initialized MethodDescriptor object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">full_name</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">service_name</span><span class="p">,</span> <span class="n">method_proto</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="n">input_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetTypeFromScope</span><span class="p">(</span>
        <span class="n">package</span><span class="p">,</span> <span class="n">method_proto</span><span class="o">.</span><span class="n">input_type</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="n">output_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_GetTypeFromScope</span><span class="p">(</span>
        <span class="n">package</span><span class="p">,</span> <span class="n">method_proto</span><span class="o">.</span><span class="n">output_type</span><span class="p">,</span> <span class="n">scope</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">MethodDescriptor</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">method_proto</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                       <span class="n">full_name</span><span class="o">=</span><span class="n">full_name</span><span class="p">,</span>
                                       <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
                                       <span class="n">containing_service</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                       <span class="n">input_type</span><span class="o">=</span><span class="n">input_type</span><span class="p">,</span>
                                       <span class="n">output_type</span><span class="o">=</span><span class="n">output_type</span><span class="p">,</span>
                                       <span class="n">options</span><span class="o">=</span><span class="n">_OptionsOrNone</span><span class="p">(</span><span class="n">method_proto</span><span class="p">))</span>

  <span class="k">def</span> <span class="nf">_ExtractSymbols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">descriptors</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Pulls out all the symbols from descriptor protos.</span>

<span class="sd">    Args:</span>
<span class="sd">      descriptors: The messages to extract descriptors from.</span>
<span class="sd">    Yields:</span>
<span class="sd">      A two element tuple of the type name and descriptor object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">descriptors</span><span class="p">:</span>
      <span class="k">yield</span> <span class="p">(</span><span class="n">_PrefixWithDot</span><span class="p">(</span><span class="n">desc</span><span class="o">.</span><span class="n">full_name</span><span class="p">),</span> <span class="n">desc</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ExtractSymbols</span><span class="p">(</span><span class="n">desc</span><span class="o">.</span><span class="n">nested_types</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">symbol</span>
      <span class="k">for</span> <span class="n">enum</span> <span class="ow">in</span> <span class="n">desc</span><span class="o">.</span><span class="n">enum_types</span><span class="p">:</span>
        <span class="k">yield</span> <span class="p">(</span><span class="n">_PrefixWithDot</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">full_name</span><span class="p">),</span> <span class="n">enum</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_GetDeps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dependencies</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Recursively finds dependencies for file protos.</span>

<span class="sd">    Args:</span>
<span class="sd">      dependencies: The names of the files being depended on.</span>

<span class="sd">    Yields:</span>
<span class="sd">      Each direct and indirect dependency.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">dependency</span> <span class="ow">in</span> <span class="n">dependencies</span><span class="p">:</span>
      <span class="n">dep_desc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FindFileByName</span><span class="p">(</span><span class="n">dependency</span><span class="p">)</span>
      <span class="k">yield</span> <span class="n">dep_desc</span>
      <span class="k">for</span> <span class="n">parent_dep</span> <span class="ow">in</span> <span class="n">dep_desc</span><span class="o">.</span><span class="n">dependencies</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">parent_dep</span>

  <span class="k">def</span> <span class="nf">_GetTypeFromScope</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">package</span><span class="p">,</span> <span class="n">type_name</span><span class="p">,</span> <span class="n">scope</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Finds a given type name in the current scope.</span>

<span class="sd">    Args:</span>
<span class="sd">      package: The package the proto should be located in.</span>
<span class="sd">      type_name: The name of the type to be found in the scope.</span>
<span class="sd">      scope: Dict mapping short and full symbols to message and enum types.</span>

<span class="sd">    Returns:</span>
<span class="sd">      The descriptor for the requested type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">type_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">:</span>
      <span class="n">components</span> <span class="o">=</span> <span class="n">_PrefixWithDot</span><span class="p">(</span><span class="n">package</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
      <span class="k">while</span> <span class="n">components</span><span class="p">:</span>
        <span class="n">possible_match</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span> <span class="o">+</span> <span class="p">[</span><span class="n">type_name</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">possible_match</span> <span class="ow">in</span> <span class="n">scope</span><span class="p">:</span>
          <span class="n">type_name</span> <span class="o">=</span> <span class="n">possible_match</span>
          <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">components</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scope</span><span class="p">[</span><span class="n">type_name</span><span class="p">]</span></div>


<span class="k">def</span> <span class="nf">_PrefixWithDot</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">name</span>


<span class="k">if</span> <span class="n">_USE_C_DESCRIPTORS</span><span class="p">:</span>
  <span class="c1"># TODO(amauryfa): This pool could be constructed from Python code, when we</span>
  <span class="c1"># support a flag like &#39;use_cpp_generated_pool=True&#39;.</span>
  <span class="c1"># pylint: disable=protected-access</span>
  <span class="n">_DEFAULT</span> <span class="o">=</span> <span class="n">descriptor</span><span class="o">.</span><span class="n">_message</span><span class="o">.</span><span class="n">default_pool</span>
<span class="k">else</span><span class="p">:</span>
  <span class="n">_DEFAULT</span> <span class="o">=</span> <span class="n">DescriptorPool</span><span class="p">()</span>


<div class="viewcode-block" id="Default"><a class="viewcode-back" href="../../../third-party/protobuf/python/docs/google/protobuf/descriptor_pool.html#google.protobuf.descriptor_pool.Default">[docs]</a><span class="k">def</span> <span class="nf">Default</span><span class="p">():</span>
  <span class="k">return</span> <span class="n">_DEFAULT</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sam Partee

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>