

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>smartsim.experiment &mdash; SmartSim 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> SmartSim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../doc/experiment.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/generate.html">Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/launchers.html">Launchers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/cmdservers.html">Command Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/developers.html">Developer</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../doc/examples/basic.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/examples/ensembles.html">Generate and Run Ensembles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/examples/jupyter.html">Connect Jupyter to a Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/examples/urika.html">Leverage Cray Urika</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/examples/MPO.html">Optimize Model Parameters</a></li>
</ul>
<p class="caption"><span class="caption-text">Clients</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../doc/clients/fortran.html">Fortran</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/clients/c-plus.html">C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/clients/c.html">C</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/clients/python.html">Python</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../doc/api/experiment.html">Experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/api/client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/api/remote.html">Remote</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc/api/utilities.html">Utilities</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SmartSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>smartsim.experiment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for smartsim.experiment</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">zmq</span>

<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">path</span><span class="p">,</span> <span class="n">mkdir</span><span class="p">,</span> <span class="n">listdir</span><span class="p">,</span> <span class="n">getcwd</span><span class="p">,</span> <span class="n">environ</span>
<span class="kn">from</span> <span class="nn">.error</span> <span class="kn">import</span> <span class="n">SmartSimError</span><span class="p">,</span> <span class="n">SSConfigError</span>
<span class="kn">from</span> <span class="nn">.orchestrator</span> <span class="kn">import</span> <span class="n">Orchestrator</span>
<span class="kn">from</span> <span class="nn">.entity</span> <span class="kn">import</span> <span class="n">SmartSimEntity</span><span class="p">,</span> <span class="n">SmartSimNode</span><span class="p">,</span> <span class="n">NumModel</span><span class="p">,</span> <span class="n">Ensemble</span>
<span class="kn">from</span> <span class="nn">.generation</span> <span class="kn">import</span> <span class="n">Generator</span>
<span class="kn">from</span> <span class="nn">.control</span> <span class="kn">import</span> <span class="n">Controller</span>
<span class="kn">from</span> <span class="nn">.launcher</span> <span class="kn">import</span> <span class="n">LocalLauncher</span>

<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">get_logger</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="Experiment"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment">[docs]</a><span class="k">class</span> <span class="nc">Experiment</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;In SmartSim, the Experiment class is an entity creation API</span>
<span class="sd">       that both houses and operates on the entities it creates.</span>
<span class="sd">       The entities that can be created are:</span>

<span class="sd">         - NumModels</span>
<span class="sd">         - Ensembles</span>
<span class="sd">         - SmartSimNodes</span>
<span class="sd">         - Orchestrator</span>

<span class="sd">        Each entity has a distinct purpose within an experiment.</span>

<span class="sd">        NumModel</span>
<span class="sd">        --------</span>
<span class="sd">        Instances of numerical models or &quot;simulation&quot; models. NumModels can</span>
<span class="sd">        be created through a call to Experiment.create_model() and though</span>
<span class="sd">        the creation of an Ensemble.</span>

<span class="sd">        Ensemble</span>
<span class="sd">        --------</span>
<span class="sd">        Ensembles are groups of NumModels to be either generated manually or</span>
<span class="sd">        through a call to experiment.generate(). Ensembles can be given model</span>
<span class="sd">        parameters to be written into input files for the model at runtime.</span>
<span class="sd">        There are multiple ways of generating ensemble members; see</span>
<span class="sd">        experiment.generate() for details.</span>

<span class="sd">        SmartSimNodes</span>
<span class="sd">        -------------</span>
<span class="sd">        Nodes run processes adjacent to the simulation. Nodes can be used</span>
<span class="sd">        for anything from analysis, training, inference, etc. Nodes are the</span>
<span class="sd">        most flexible entity with no requirements on language or framework.</span>
<span class="sd">        Nodes are commonly used for acting on data being streamed out of a</span>
<span class="sd">        simulation model through the orchestrator</span>

<span class="sd">        Orchestrator</span>
<span class="sd">        ------------</span>
<span class="sd">        The Orchestrator is a KeyDB database, clustered or standalone, that</span>
<span class="sd">        is launched prior to the simulation. The Orchestrator can be used</span>
<span class="sd">        to store data from another entity in memory during the course of</span>
<span class="sd">        an experiment. In order to stream data into the orchestrator or</span>
<span class="sd">        recieve data from the orchestrator, one of the SmartSim clients</span>
<span class="sd">        has to be used within a NumModel or SmartSimNode. Use</span>
<span class="sd">        experiment.register_connection() to connect two entities within</span>
<span class="sd">        SmartSim.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">launcher</span><span class="o">=</span><span class="s2">&quot;slurm&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize an Experiment</span>

<span class="sd">        :param name: Name of the experiment</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param launcher: type of launcher, options are &quot;local&quot; and &quot;slurm&quot;,</span>
<span class="sd">                         defaults to &quot;slurm&quot;</span>
<span class="sd">        :type launcher: str, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_control</span> <span class="o">=</span> <span class="n">Controller</span><span class="p">(</span><span class="n">launcher</span><span class="o">=</span><span class="n">launcher</span><span class="p">)</span>

<div class="viewcode-block" id="Experiment.start"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.start">[docs]</a>    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ensembles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ssnodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orchestrator</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Start the experiment by turning all entities into jobs</span>
<span class="sd">           for the underlying launcher specified at experiment</span>
<span class="sd">           initialization. All entities in the experiemnt will be</span>
<span class="sd">           launched if not arguments are passed.</span>

<span class="sd">        :param ensembles: list of Ensembles, defaults to None</span>
<span class="sd">        :type ensembles: list Ensemble instances, optional</span>
<span class="sd">        :param ssnodes: list of SmartSimNodes, defaults to None</span>
<span class="sd">        :type ssnodes: list of SmartSimNode instances, optional</span>
<span class="sd">        :param orchestrator: Orchestrator instance, defaults to None</span>
<span class="sd">        :type orchestrator: Orchestrator, optional</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting experiment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ensembles</span><span class="p">:</span>
                <span class="n">ensembles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ssnodes</span><span class="p">:</span>
                <span class="n">ssnodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">orchestrator</span><span class="p">:</span>
                <span class="n">orchestrator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">start</span><span class="p">(</span>
                <span class="n">ensembles</span><span class="o">=</span><span class="n">ensembles</span><span class="p">,</span>
                <span class="n">nodes</span><span class="o">=</span><span class="n">ssnodes</span><span class="p">,</span>
                <span class="n">orchestrator</span><span class="o">=</span><span class="n">orchestrator</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.stop"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.stop">[docs]</a>    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ensembles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">models</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">orchestrator</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop specific entities launched through SmartSim. This method is only</span>
<span class="sd">           applicable when launching with a workload manager.</span>

<span class="sd">           :param ensembles: Ensemble objects to be stopped</span>
<span class="sd">           :type Ensembles: list of Ensemble objects</span>
<span class="sd">           :param models: Specific models to be stopped</span>
<span class="sd">           :type models: list of Model objects</span>
<span class="sd">           :param nodes: SmartSimNodes to be stopped</span>
<span class="sd">           :type nodes: list of SmartSimNodes</span>
<span class="sd">           :param orchestrator: the orchestrator to be stoppped</span>
<span class="sd">           :type orchestrator: instance of Orchestrator</span>
<span class="sd">           :raises: SmartSimError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span>
                <span class="n">ensembles</span><span class="o">=</span><span class="n">ensembles</span><span class="p">,</span>
                <span class="n">models</span><span class="o">=</span><span class="n">models</span><span class="p">,</span>
                <span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span>
                <span class="n">orchestrator</span><span class="o">=</span><span class="n">orchestrator</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.get_allocation"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.get_allocation">[docs]</a>    <span class="k">def</span> <span class="nf">get_allocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ppn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s2">&quot;1:00:00&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get an allocation through the launcher for future calls</span>
<span class="sd">           to start to launch entities onto. This allocation is</span>
<span class="sd">           maintained within SmartSim. To release the allocation</span>
<span class="sd">           call Experiment.release().</span>

<span class="sd">           The kwargs can be used to pass extra settings to the</span>
<span class="sd">           workload manager such as the following for Slurm:</span>
<span class="sd">             - nodelist=&quot;nid00004&quot;</span>

<span class="sd">           For arguments without a value, pass None or and empty</span>
<span class="sd">           string as the value for the kwarg. For Slurm:</span>
<span class="sd">             - exclusive=None</span>

<span class="sd">        :param nodes: number of nodes for the allocation</span>
<span class="sd">        :type nodes: int</span>
<span class="sd">        :param ppn: processes per node</span>
<span class="sd">        :type ppn: int</span>
<span class="sd">        :param duration: length of the allocation in HH:MM:SS format,</span>
<span class="sd">                         defaults to &quot;1:00:00&quot;</span>
<span class="sd">        :type duration: str, optional</span>
<span class="sd">        :raises SmartSimError: if allocation could not be obtained</span>
<span class="sd">        :return: allocation id</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">alloc_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">get_allocation</span><span class="p">(</span>
                <span class="n">nodes</span><span class="o">=</span><span class="n">nodes</span><span class="p">,</span>
                <span class="n">ppn</span><span class="o">=</span><span class="n">ppn</span><span class="p">,</span>
                <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">alloc_id</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="Experiment.add_allocation"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.add_allocation">[docs]</a>    <span class="k">def</span> <span class="nf">add_allocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alloc_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an allocation to SmartSim such that entities can</span>
<span class="sd">           be launched on it.</span>

<span class="sd">        :param alloc_id: id of the allocation from the workload manager</span>
<span class="sd">        :type alloc_id: str</span>
<span class="sd">        :raises SmartSimError: If the allocation cannot be found</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">add_allocation</span><span class="p">(</span><span class="n">alloc_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span></div>

<div class="viewcode-block" id="Experiment.stop_all"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.stop_all">[docs]</a>    <span class="k">def</span> <span class="nf">stop_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Stop all entities that were created with this experiment</span>

<span class="sd">            :raises: SmartSimError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span>
                <span class="n">ensembles</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">,</span>
                <span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span>
                <span class="n">orchestrator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orc</span>
                <span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.release"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.release">[docs]</a>    <span class="k">def</span> <span class="nf">release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alloc_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Release the allocation(s) stopping all jobs that are</span>
<span class="sd">           currently running and freeing up resources. If an</span>
<span class="sd">           allocation ID is provided, only stop that allocation</span>
<span class="sd">           and remove it from SmartSim.</span>

<span class="sd">        :param alloc_id: id of the allocation, defaults to None</span>
<span class="sd">        :type alloc_id: str, optional</span>
<span class="sd">        :raises SmartSimError: if fail to release allocation</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">release</span><span class="p">(</span><span class="n">alloc_id</span><span class="o">=</span><span class="n">alloc_id</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.poll"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.poll">[docs]</a>    <span class="k">def</span> <span class="nf">poll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">poll_db</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Poll the running simulations and recieve logging output</span>
<span class="sd">           with the status of the job. If polling the database,</span>
<span class="sd">           jobs will continue until database is manually shutdown.</span>

<span class="sd">           :param int interval: number of seconds to wait before polling again</span>
<span class="sd">           :param bool poll_db: poll dbnodes for status as well and see</span>
<span class="sd">                                it in the logging output</span>
<span class="sd">           :param bool verbose: set verbosity</span>
<span class="sd">           :raises: SmartSimError</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">poll</span><span class="p">(</span><span class="n">interval</span><span class="p">,</span> <span class="n">poll_db</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="Experiment.finished"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.finished">[docs]</a>    <span class="k">def</span> <span class="nf">finished</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a boolean indicating wether or not a job has finished.</span>

<span class="sd">           :param entity: object launched by SmartSim. One of the following:</span>
<span class="sd">                          (SmartSimNode, NumModel, Orchestrator, Ensemble)</span>
<span class="sd">           :type entity: SmartSimEntity</span>
<span class="sd">           :returns: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">finished</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="Experiment.generate"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.generate">[docs]</a>    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">node_files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;all_perm&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate the file structure for a SmartSim experiment. This</span>
<span class="sd">           includes the writing and configuring of input files for a</span>
<span class="sd">           model. Ensembles created with a &#39;params&#39; argument will be</span>
<span class="sd">           expanded into multiple models based on a generation strategy.</span>
<span class="sd">           Model input files are specified with the model_files argument.</span>
<span class="sd">           All files and directories listed as strings in a list will be</span>
<span class="sd">           copied to each model within an ensemble. Every model file is read,</span>
<span class="sd">           checked for input variables to configure, and written. Input</span>
<span class="sd">           variables to configure are specified with a tag within the input</span>
<span class="sd">           file itself. The default tag is surronding an input value with</span>
<span class="sd">           semicolons. e.g. THERMO=;90;</span>

<span class="sd">           Files for SmartSimNodes can also be included to be copied into</span>
<span class="sd">           node directories but are never read nor written. All node_files</span>
<span class="sd">           will be copied into directories named after the name of the</span>
<span class="sd">           SmartSimNode within the experiment.</span>

<span class="sd">            :param model_files: The model files for the experiment.  Optional</span>
<span class="sd">                                if model files are not needed for execution.</span>
<span class="sd">            :type model_files: list of path like strings to directories or files</span>
<span class="sd">            :param node_files: files to be copied into node directories. These</span>
<span class="sd">                               are most likely files needed to run the node</span>
<span class="sd">                               computations. e.g. a python script</span>
<span class="sd">            :type node_files: list of path like strings to directories or files</span>

<span class="sd">            :param str strategy: The permutation strategy for generating models within</span>
<span class="sd">                                ensembles.</span>
<span class="sd">                                Options are &quot;all_perm&quot;, &quot;random&quot;, &quot;step&quot;, or a</span>
<span class="sd">                                callable function. Defaults to &quot;all_perm&quot;</span>
<span class="sd">            :raises SmartSimError: if generation fails</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">generator</span> <span class="o">=</span> <span class="n">Generator</span><span class="p">()</span>
            <span class="n">generator</span><span class="o">.</span><span class="n">set_strategy</span><span class="p">(</span><span class="n">strategy</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tag</span><span class="p">:</span>
                <span class="n">generator</span><span class="o">.</span><span class="n">set_tag</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">generator</span><span class="o">.</span><span class="n">generate_experiment</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">exp_path</span><span class="p">,</span>
                <span class="n">ensembles</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">,</span>
                <span class="n">nodes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span>
                <span class="n">orchestrator</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="p">,</span>
                <span class="n">model_files</span><span class="o">=</span><span class="n">model_files</span><span class="p">,</span>
                <span class="n">node_files</span><span class="o">=</span><span class="n">node_files</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.get_status"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.get_status">[docs]</a>    <span class="k">def</span> <span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the status of a running job that was launched through</span>
<span class="sd">           a workload manager. Ensembles, Orchestrator, SmartSimNodes,</span>
<span class="sd">           and NumModel instances can all be passed to have their</span>
<span class="sd">           status returned as a string. The type of string and content</span>
<span class="sd">           will depend on the workload manager being used.</span>

<span class="sd">           :param entity: The SmartSimEntity object that was launched</span>
<span class="sd">                          to check the status of</span>
<span class="sd">           :type entity: SmartSimEntity</span>
<span class="sd">           :returns: status of the entity</span>
<span class="sd">           :rtype: list if entity contains sub-entities such as cluster</span>
<span class="sd">                   Orchestrator or Ensemble</span>
<span class="sd">           :raises SmartSimError: if status retrieval fails</span>
<span class="sd">           :raises TypeError: if one argument was not a SmartSimEntitiy</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">Ensemble</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">get_ensemble_status</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">Orchestrator</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">get_orchestrator_status</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">NumModel</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">get_model_status</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">entity</span><span class="p">,</span> <span class="n">SmartSimNode</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">get_node_status</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;entity argument was of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">entity</span><span class="p">)</span><span class="si">}</span><span class="s2"> not SmartSimEntity&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>


<div class="viewcode-block" id="Experiment.create_ensemble"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.create_ensemble">[docs]</a>    <span class="k">def</span> <span class="nf">create_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span> <span class="n">run_settings</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Create a ensemble to be used within one or many of the</span>
<span class="sd">           SmartSim Modules. Ensembles contain groups of models.</span>
<span class="sd">           Parameters can be given to a ensemble in order to generate</span>
<span class="sd">           models based on a combination of parameters and generation</span>
<span class="sd">           strategies. For more on generation strategies, see the</span>
<span class="sd">           Generator Class.</span>

<span class="sd">        :param name: name of the ensemble</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param params: model parameters for generation strategies,</span>
<span class="sd">                       defaults to {}</span>
<span class="sd">        :type params: dict, optional</span>
<span class="sd">        :param run_settings: define how the model should be run,</span>
<span class="sd">                             defaults to {}</span>
<span class="sd">        :type run_settings: dict, optional</span>
<span class="sd">        :raises SmartSimError: If ensemble cannot be created</span>
<span class="sd">        :return: the created Ensemble</span>
<span class="sd">        :rtype: Ensemble</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">new_ensemble</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">ensemble</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;A ensemble named &quot;</span> <span class="o">+</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span>
                                        <span class="s2">&quot; already exists!&quot;</span><span class="p">)</span>

            <span class="n">ensemble_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_path</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">ensemble_path</span><span class="p">):</span>
                <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span>
                    <span class="s2">&quot;ensemble directory already exists:&quot;</span><span class="p">,</span><span class="n">ensemble_path</span><span class="p">))</span>
                <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">new_ensemble</span> <span class="o">=</span> <span class="n">Ensemble</span><span class="p">(</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">params</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                    <span class="n">ensemble_path</span><span class="p">,</span>
                                    <span class="n">run_settings</span><span class="o">=</span><span class="n">run_settings</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ensemble</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">new_ensemble</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.create_model"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.create_model">[docs]</a>    <span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ensemble</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">run_settings</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Create a model belonging to a specific ensemble. This function is</span>
<span class="sd">           useful for running a small number of models where the model files</span>
<span class="sd">           are already in place for execution.</span>

<span class="sd">           Calls to this function without specifying the `ensemble` argument</span>
<span class="sd">           result in the creation/usage a ensemble named &quot;default&quot;, the default</span>
<span class="sd">           argument for `ensemble`.</span>

<span class="sd">           Models in the default ensemble will be launched with their specific</span>
<span class="sd">           run_settings as defined in intialization here. Otherwise the model</span>
<span class="sd">           will use the run_settings defined for the Ensemble</span>

<span class="sd">        :param name: name of the model</span>
<span class="sd">        :type name: str</span>
<span class="sd">        :param ensemble: name of the ensemble to add the model to,</span>
<span class="sd">                         defaults to &quot;default&quot;</span>
<span class="sd">        :type ensemble: str, optional</span>
<span class="sd">        :param params: model parameters for generation strategies,</span>
<span class="sd">                       defaults to {}</span>
<span class="sd">        :type params: dict, optional</span>
<span class="sd">        :param path: path to where the model should be executed at runtime,</span>
<span class="sd">                     defaults to os.getcwd()</span>
<span class="sd">        :type path: str, optional</span>
<span class="sd">        :param run_settings: defines how the model should be run,</span>
<span class="sd">                             defaults to {}</span>
<span class="sd">        :type run_settings: dict, optional</span>
<span class="sd">        :raises SmartSimError: if ensemble name provided doesnt exist</span>
<span class="sd">        :return: the created model</span>
<span class="sd">        :rtype: NumModel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">model_added</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">NumModel</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">run_settings</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">ensemble</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span> <span class="ow">and</span> <span class="s2">&quot;default&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                    <span class="n">ensemble</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">ensemble</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">]:</span>

                <span class="c1"># create empty ensemble</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">create_ensemble</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{},</span> <span class="n">run_settings</span><span class="o">=</span><span class="p">{})</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">ensemble</span><span class="p">:</span>
                    <span class="n">t</span><span class="o">.</span><span class="n">add_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
                    <span class="n">model_added</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">model_added</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;Could not find ensemble by the name of: &quot;</span> <span class="o">+</span>
                                    <span class="n">ensemble</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">model</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.create_orchestrator_cluster"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.create_orchestrator_cluster">[docs]</a>    <span class="k">def</span> <span class="nf">create_orchestrator_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alloc</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">db_nodes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                     <span class="n">dpn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an in-memory database that can be used for the transfer of</span>
<span class="sd">           data between launched entities. For increasing throughput,</span>
<span class="sd">           the number of databases per node can be increased such that mulitple</span>
<span class="sd">           database instances are launched on a single node and share the</span>
<span class="sd">           memory of that node.</span>

<span class="sd">           Orchestrator clusters are meant to be launched accross multiple</span>
<span class="sd">           nodes with the minimum number of nodes being 3. Clusters of size</span>
<span class="sd">           2 are not supported and single instances will be launched in</span>
<span class="sd">           standalone mode. This function requires that an allocation id</span>
<span class="sd">           is passed for the orchestrator to run on. If you want to run</span>
<span class="sd">           an orchestrator locally, look at Experiment.create_orchestrator().</span>

<span class="sd">           Additional options for where and how to launch the orchestrator</span>
<span class="sd">           can be specified with the through the inclusion of extra kwargs</span>
<span class="sd">           (e.g. partition=&quot;main&quot;)</span>


<span class="sd">        :param alloc: id of the allocation for the orchestrator to run on</span>
<span class="sd">        :type alloc: str</span>
<span class="sd">        :param path: desired path for orchestrator output/error, defaults to cwd</span>
<span class="sd">        :type path: str, optional</span>
<span class="sd">        :param port: port orchestrator should run on, defaults to 6379</span>
<span class="sd">        :type port: int, optional</span>
<span class="sd">        :param db_nodes: number of database nodes in the cluster, defaults to 3</span>
<span class="sd">        :type db_nodes: int, optional</span>
<span class="sd">        :param dpn: number of databases per node, defaults to 1</span>
<span class="sd">        :type dpn: int, optional</span>
<span class="sd">        :raises SmartSimError: if an orchestrator already exists within the</span>
<span class="sd">                               experiment</span>
<span class="sd">        :raises SmartSimError: If experiment was initialized with local launcher</span>
<span class="sd">        :return: Orchestrator instance</span>
<span class="sd">        :rtype: Orchestrator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span>
                    <span class="s2">&quot;Only one orchestrator can exist within a experiment.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">_launcher</span><span class="p">,</span> <span class="n">LocalLauncher</span><span class="p">):</span>
                <span class="n">error</span> <span class="o">=</span> <span class="s2">&quot;Clustered orchestrators are not supported when using the local launcher</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot;Use Experiment.create_orchestrator() for launching an orchestrator&quot;</span>
                <span class="n">error</span> <span class="o">+=</span> <span class="s2">&quot;with the local launcher&quot;</span>
                <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
            <span class="n">orcpath</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">orcpath</span> <span class="o">=</span> <span class="n">path</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">orc</span> <span class="o">=</span> <span class="n">Orchestrator</span><span class="p">(</span><span class="n">orcpath</span><span class="p">,</span>
                                    <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                                    <span class="n">db_nodes</span><span class="o">=</span><span class="n">db_nodes</span><span class="p">,</span>
                                    <span class="n">dpn</span><span class="o">=</span><span class="n">dpn</span><span class="p">,</span>
                                    <span class="n">alloc</span><span class="o">=</span><span class="n">alloc</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.create_orchestrator"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.create_orchestrator">[docs]</a>    <span class="k">def</span> <span class="nf">create_orchestrator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an in-memory database to run with an experiment. Launched</span>
<span class="sd">           entities can communicate with the orchestrator through use</span>
<span class="sd">           of one of the Python, C, C++ or Fortran clients.</span>

<span class="sd">           With the default settings, this function can be used to create</span>
<span class="sd">           a local orchestrator that will run in parallel with other</span>
<span class="sd">           entities running serially in an experiment. For creating</span>
<span class="sd">           clustered orchestrators accross multiple compute nodes</span>
<span class="sd">           look at Experiment.create_orchestrator_cluster()</span>

<span class="sd">        :param path: desired path for orchestrator output/error, defaults to cwd</span>
<span class="sd">        :type path: str, optional</span>
<span class="sd">        :param port: port orchestrator should run on, defaults to 6379</span>
<span class="sd">        :type port: int, optional</span>
<span class="sd">        :raises SmartSimError: if an orchestrator already exists</span>
<span class="sd">        :return: Orchestrator instance created</span>
<span class="sd">        :rtype: Orchestrator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span>
                    <span class="s2">&quot;Only one orchestrator can exist within a experiment.&quot;</span><span class="p">)</span>
            <span class="n">orcpath</span> <span class="o">=</span> <span class="n">getcwd</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">orcpath</span> <span class="o">=</span> <span class="n">path</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">orc</span> <span class="o">=</span> <span class="n">Orchestrator</span><span class="p">(</span><span class="n">orcpath</span><span class="p">,</span>
                                    <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                                    <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.create_node"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.create_node">[docs]</a>    <span class="k">def</span> <span class="nf">create_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">script_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_settings</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;Create a SmartSimNode for a specific task. Examples of SmartSimNode</span>
<span class="sd">           tasks include training, processing, and inference. Nodes can be used</span>
<span class="sd">           to run any task written in any language. The included script/executable</span>
<span class="sd">           for nodes often use the Client class to send and recieve data from</span>
<span class="sd">           the SmartSim orchestrator.</span>

<span class="sd">           :param str name: name of the node to be launched</span>
<span class="sd">           :param str script_path: path to the script or executable to be launched.</span>
<span class="sd">                                   (default is the current working directory of the</span>
<span class="sd">                                    SmartSim run script)</span>
<span class="sd">           :param dict run_settings: Settings for the workload manager can be set by</span>
<span class="sd">                                     including keyword arguments such as</span>
<span class="sd">                                     duration=&quot;1:00:00&quot; or nodes=5</span>
<span class="sd">           :raises: SmartSimError if node exists by the same name</span>
<span class="sd">           :returns: SmartSimNode created</span>
<span class="sd">           :rtype: SmartSimNode</span>
<span class="sd">           &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;A node named &quot;</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span>
                                        <span class="s2">&quot; already exists!&quot;</span><span class="p">)</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">SmartSimNode</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">script_path</span><span class="p">,</span> <span class="n">run_settings</span><span class="o">=</span><span class="n">run_settings</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">node</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.register_connection"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.register_connection">[docs]</a>    <span class="k">def</span> <span class="nf">register_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">reciever</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a runtime connection in orchestrator for data to be passed</span>
<span class="sd">           between two SmartSim entities. The possible types of connections</span>
<span class="sd">           right now are:</span>

<span class="sd">                Model -&gt; Node</span>
<span class="sd">                Node  -&gt; Node</span>
<span class="sd">                Node  -&gt; Model</span>

<span class="sd">           :param str sender: name of the created entity with a Client instance</span>
<span class="sd">                              to send data to a registered counterpart</span>
<span class="sd">           :param str reciever: name of the created entity that will recieve</span>
<span class="sd">                                data by making calls to a Client instance.</span>
<span class="sd">           :raises TypeError: if arguments are not str names of entities</span>
<span class="sd">           :raises SmartSimError: if orchestrator has not been created</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reciever</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;Arguments to register connection must either be a str&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;Create orchestrator to register connections&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># TODO check if sender and reciever are registered entities</span>
                <span class="c1"># TODO check for illegal connection types. e.g. model to model</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="o">.</span><span class="n">junction</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">reciever</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.create_connection"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.create_connection">[docs]</a>    <span class="k">def</span> <span class="nf">create_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a connection between the experiment script and</span>
<span class="sd">           SmartSim entity. This method should be called after a</span>
<span class="sd">           database has been launched or an error will be raised.</span>

<span class="sd">           :param str sender: name of the created entity with a</span>
<span class="sd">                              Client instance to send data to</span>
<span class="sd">                              this smartsim script</span>
<span class="sd">           :raises SmartSimError: if orchestrator has not been created</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;Create orchestrator to register connections&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SSDB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_db_address</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SSNAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
        <span class="n">environ</span><span class="p">[</span><span class="s2">&quot;SSDATAIN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sender</span></div>


<div class="viewcode-block" id="Experiment.delete_ensemble"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.delete_ensemble">[docs]</a>    <span class="k">def</span> <span class="nf">delete_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Delete a created ensemble from Experiment so that</span>
<span class="sd">           any future calls to SmartSim Modules will not include</span>
<span class="sd">           this ensemble.</span>

<span class="sd">           :param str name: name of the ensemble to be deleted</span>
<span class="sd">           :raises TypeError: if argument is not a str name of an ensemble</span>
<span class="sd">           :raises SmartSimError: if ensemble doesnt exist</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">SmartSimEntity</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument to delete_ensemble must be of type str&quot;</span><span class="p">)</span>
            <span class="n">ensemble_deleted</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                    <span class="n">ensemble_deleted</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ensemble_deleted</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;Could not delete ensemble: &quot;</span> <span class="o">+</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.get_model"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.get_model">[docs]</a>    <span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">ensemble</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a specific model from a ensemble.</span>

<span class="sd">           :param str model: name of the model to return</span>
<span class="sd">           :param str ensemble: name of the ensemble where the model is located</span>

<span class="sd">           :raises SmartSimError: if model is not found</span>
<span class="sd">           :raises TypeError: if arguments are not str names of a model</span>
<span class="sd">                              and/or an Ensemble</span>
<span class="sd">           :returns: NumModel instance</span>
<span class="sd">           :rtype: NumModel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Ensemble argument to get_model must be of type str&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Model argument to get_model must be of type str&quot;</span><span class="p">)</span>

            <span class="n">ensemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ensemble</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">ensemble</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">model</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;Model not found: &quot;</span> <span class="o">+</span> <span class="n">model</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.get_ensemble"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.get_ensemble">[docs]</a>    <span class="k">def</span> <span class="nf">get_ensemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ensemble</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a specific ensemble from Experiment</span>

<span class="sd">           :param str ensemble: Name of the ensemble to return</span>
<span class="sd">           :raises SmartSimError: if ensemble is not found</span>
<span class="sd">           :raises TypeError: if argument is not a str name of</span>
<span class="sd">                              an ensemble</span>
<span class="sd">           :returns: ensemble instance</span>
<span class="sd">           :rtype: Ensemble</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ensemble</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument to get_ensemble must be of type str&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">ensemble</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">t</span>
            <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;ensemble not found: &quot;</span> <span class="o">+</span> <span class="n">ensemble</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.get_node"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.get_node">[docs]</a>    <span class="k">def</span> <span class="nf">get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a specific node from Experiment</span>

<span class="sd">           :param str node: Name of the node to return</span>
<span class="sd">           :raises SmartSimError: if node cannot be found</span>
<span class="sd">           :raises TypeError: if argument is not a str name</span>
<span class="sd">                    of an node</span>
<span class="sd">           :returns: node instance</span>
<span class="sd">           :rtype: SmartSimNode</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument to get_node must be of type str&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">node</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">n</span>
            <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;Node not found: &quot;</span> <span class="o">+</span> <span class="n">node</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SmartSimError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="Experiment.get_db_address"><a class="viewcode-back" href="../../doc/api/experiment.html#smartsim.experiment.Experiment.get_db_address">[docs]</a>    <span class="k">def</span> <span class="nf">get_db_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the TCP address of the orchestrator returned by pinging the</span>
<span class="sd">           domain name used by the workload manager e.g. nid00004 returns</span>
<span class="sd">           127.0.0.1</span>

<span class="sd">           :raises SmartSimError: if orchestrator has not been launched</span>
<span class="sd">           :raises: SmartSimError: if database nodes cannot be found</span>
<span class="sd">           :returns: tcp address of orchestrator</span>
<span class="sd">           :rtype: returns a list if clustered orchestrator</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;No orchestrator has been initialized&quot;</span><span class="p">)</span>
        <span class="n">addresses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dbnode</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="o">.</span><span class="n">dbnodes</span><span class="p">:</span>
            <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_control</span><span class="o">.</span><span class="n">_jobs</span><span class="p">[</span><span class="n">dbnode</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">job</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;Database has not been launched yet.&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">job</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">dbnode</span><span class="o">.</span><span class="n">ports</span><span class="p">:</span>
                    <span class="n">addr</span> <span class="o">=</span> <span class="s2">&quot;:&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">address</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">)))</span>
                    <span class="n">addresses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">addresses</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SmartSimError</span><span class="p">(</span><span class="s2">&quot;Could not find nodes Database was launched on&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">addresses</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">experiment_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-- Experiment Summary --</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">experiment_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-- ensembles --&quot;</span>
            <span class="k">for</span> <span class="n">ensemble</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ensembles</span><span class="p">:</span>
                <span class="n">experiment_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ensemble</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">experiment_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-- Nodes --&quot;</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="n">experiment_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="p">:</span>
            <span class="n">experiment_str</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">orc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">experiment_str</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sam Partee

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>