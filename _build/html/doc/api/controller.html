

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Controller &mdash; SmartSim 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Client" href="client.html" />
    <link rel="prev" title="Generator" href="generator.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> SmartSim
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">General</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../generate.html">Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../simulate.html">Simulation Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developers.html">Developer</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/cp2k.html">Ensembling CP2K Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/online-training.html">Use Machine Learning In Simulation</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="state.html">State</a></li>
<li class="toctree-l1"><a class="reference internal" href="simModule.html">SmartSimModule</a></li>
<li class="toctree-l1"><a class="reference internal" href="generator.html">Generator</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="client.html">Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SmartSim</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Controller</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/doc/api/controller.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="controller">
<h1>Controller<a class="headerlink" href="#controller" title="Permalink to this headline">¶</a></h1>
<p>The Controller is a <code class="docutils literal notranslate"><span class="pre">SmartSimModule</span></code> that is used to run the models
generated by the <code class="docutils literal notranslate"><span class="pre">Generator</span></code> module. If the experiment structure has not first
been generated, the Controller will not be able to find and run any
models.</p>
<p>The Controller currently interfaces with the Slurm Workload manager,
but can also be run “locally” where the run command will be relayed
directly to a shell process.</p>
<p>There are three ways a user can specify arguments for the running
of simulations.</p>
<ol class="arabic simple">
<li><p>On the experiment level under the [execute] table</p></li>
</ol>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[execute]</span>
<span class="n">nodes</span> <span class="o">=</span> <span class="mi">5</span>        <span class="c1"># All targets run with 5 nodes</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>On the target level under the target’s table</p></li>
</ol>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[execute]</span>
   <span class="k">[execute.some_target]</span>
   <span class="n">run_args</span> <span class="o">=</span> <span class="s">&quot;-np 6&quot;</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>in the initialization of the Controller class</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">control</span> <span class="o">=</span> <span class="n">Controller</span><span class="p">(</span><span class="n">run_args</span><span class="o">=</span><span class="s2">&quot;-np 6&quot;</span><span class="p">,</span> <span class="n">nodes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>As it stands today, the TOML interface allows users more flexibility
with the Controller as targets can have different settings.</p>
<p>There is a hierarchy of specification that goes as
follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>initialization of the controller</p></li>
<li><p>experiment level (under <code class="docutils literal notranslate"><span class="pre">[control]</span></code> table)</p></li>
<li><p>target level (under <code class="docutils literal notranslate"><span class="pre">[control.some_target]</span></code> table)</p></li>
</ul>
</div></blockquote>
<p>This means that the arguments in the initialization
of the Controller will override any settings under the control table.
Likewise, the settings under the <code class="docutils literal notranslate"><span class="pre">[control]</span></code> table will override
any settings under target specific tables.</p>
<span class="target" id="module-smartsim.control.controller"></span><dl class="class">
<dt id="smartsim.control.controller.Controller">
<em class="property">class </em><code class="sig-prename descclassname">smartsim.control.controller.</code><code class="sig-name descname">Controller</code><span class="sig-paren">(</span><em class="sig-param">state</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smartsim/control/controller.html#Controller"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smartsim.control.controller.Controller" title="Permalink to this definition">¶</a></dt>
<dd><p>The controller module provides an interface between the numerical model
that is the subject of Smartsim and the underlying workload manager or
run framework. There are currently four methods of execution:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Local (implemented)</p></li>
<li><p>Slurm (implemented)</p></li>
<li><p>PBS   (not implemented)</p></li>
</ol>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<a class="reference internal" href="state.html#smartsim.state.State" title="smartsim.state.State"><em>State</em></a>) – A State instance</p>
</dd>
</dl>
<dl class="method">
<dt id="smartsim.control.controller.Controller.finished">
<code class="sig-name descname">finished</code><span class="sig-paren">(</span><em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smartsim/control/controller.html#Controller.finished"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smartsim.control.controller.Controller.finished" title="Permalink to this definition">¶</a></dt>
<dd><p>Poll all simulations and return a boolean for
if all jobs are finished or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>) – set verbosity</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True or False for if all models have finished</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smartsim.control.controller.Controller.get_job">
<code class="sig-name descname">get_job</code><span class="sig-paren">(</span><em class="sig-param">name</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smartsim/control/controller.html#Controller.get_job"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smartsim.control.controller.Controller.get_job" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO write docs for this</p>
</dd></dl>

<dl class="method">
<dt id="smartsim.control.controller.Controller.get_job_nodes">
<code class="sig-name descname">get_job_nodes</code><span class="sig-paren">(</span><em class="sig-param">job=None</em>, <em class="sig-param">wait=5</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smartsim/control/controller.html#Controller.get_job_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smartsim.control.controller.Controller.get_job_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the hostname(s) of a job from the allocation
if no job listed, return a dictionary of jobs and nodelists</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>job</strong> (<em>Job</em>) – A job instance</p></li>
<li><p><strong>wait</strong> (<em>int</em>) – time for wait before checking nodelist after job has been launched
defaults to 5 seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of hostnames given a job or dict of job_name -&gt; nodelist</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smartsim.control.controller.Controller.get_jobs">
<code class="sig-name descname">get_jobs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smartsim/control/controller.html#Controller.get_jobs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smartsim.control.controller.Controller.get_jobs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of jobs that this controller has spawned</p>
</dd></dl>

<dl class="method">
<dt id="smartsim.control.controller.Controller.poll">
<code class="sig-name descname">poll</code><span class="sig-paren">(</span><em class="sig-param">interval=20</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smartsim/control/controller.html#Controller.poll"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smartsim.control.controller.Controller.poll" title="Permalink to this definition">¶</a></dt>
<dd><p>Poll the running simulations and recieve logging
output with the status of the job.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval</strong> (<em>int</em>) – number of seconds to wait before polling again</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – set verbosity</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="smartsim.control.controller.Controller.start">
<code class="sig-name descname">start</code><span class="sig-paren">(</span><em class="sig-param">target=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/smartsim/control/controller.html#Controller.start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#smartsim.control.controller.Controller.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start the simulations of all targets using whatever
controller settings have been set through the Controller
initialization or in the SmartSim configuration file.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="client.html" class="btn btn-neutral float-right" title="Client" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="generator.html" class="btn btn-neutral float-left" title="Generator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sam Partee

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>