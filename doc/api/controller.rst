
Controller
==========

The Controller is a ``SmartSimModule`` that is used to run the models
generated by the ``Generator`` module. If the experiment structure has not first
been generated, the Controller will not be able to find and run any
models.

The Controller currently interfaces with the Slurm Workload manager,
but can also be run "locally" where the run command will be relayed
directly to a shell process.

There are three ways a user can specify arguments for the running
of simulations.


1) On the experiment level under the [execute] table

.. code-block:: toml

   [execute]
   nodes = 5        # All ensembles run with 5 nodes

2) On the ensemble level under the ensemble's table

.. code-block:: toml

    [execute]
       [execute.some_ensemble]
       run_args = "-np 6"

3) in the initialization of the Controller class

.. code-block:: python

   control = Controller(run_args="-np 6", nodes=5)


As it stands today, the TOML interface allows users more flexibility
with the Controller as ensembles can have different settings.

There is a hierarchy of specification that goes as
follows:
    - initialization of the controller
    - experiment level (under ``[control]`` table)
    - ensemble level (under ``[control.some_ensemble]`` table)

This means that the arguments in the initialization
of the Controller will override any settings under the control table.
Likewise, the settings under the ``[control]`` table will override
any settings under ensemble specific tables.



.. automodule:: smartsim.control.controller
   :members:
